(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    309985,       8653]
NotebookOptionsPosition[    298834,       8484]
NotebookOutlinePosition[    299261,       8501]
CellTagsIndexPosition[    299218,       8498]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->
  "In[293]:=",ExpressionUUID->"ae4340d8-7b4a-4067-b886-e6a221ec20ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q0start", "=", "54953.53841518038"}], ";", 
  RowBox[{"Q0end", "=", "54963.24481732253"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q1start", "=", "54964.511756673426"}], ";", 
  RowBox[{"Q1end", "=", "54997.98329729108"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q2start", "=", "55002.764903284085"}], ";", 
  RowBox[{"Q2end", "=", "55091.466956257034"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q3start", "=", "55093.24459723139"}], ";", 
  RowBox[{"Q3end", "=", "55182.49465072287"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q4start", "=", "55185.3658080061"}], ";", 
  RowBox[{"Q4end", "=", "55275.211866897414"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q5start", "=", "55276.47949780036"}], ";", 
  RowBox[{"Q5end", "=", "55371.17207391215"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q6start", "=", "55372.46009847967"}], ";", 
  RowBox[{"Q6end", "=", "55462.305792973355"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q7start", "=", "55463.16463513537"}], ";", 
  RowBox[{"Q7end", "=", "55552.55707265549"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q8start", "=", "55568.35242605389"}], ";", 
  RowBox[{"Q8end", "=", "55635.35368505794"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q9start", "=", "55641.52550915837"}], ";", 
  RowBox[{"Q9end", "=", "55738.935875129384"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q10start", "=", "55739.835638486584"}], ";", 
  RowBox[{"Q10end", "=", "55833.277845301614"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q11start", "=", "55834.1986379302"}], ";", 
  RowBox[{"Q11end", "=", "55931.33445044336"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q12start", "=", "55932.418064826525"}], ";", 
  RowBox[{"Q12end", "=", "56015.03062305053"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q13start", "=", "56015.72674011688"}], ";", 
  RowBox[{"Q13end", "=", "56106.066162428935"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q14start", "=", "56107.13008618061"}], ";", 
  RowBox[{"Q14end", "=", "56204.331588511515"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q15start", "=", "56206.50817485861"}], ";", 
  RowBox[{"Q15end", "=", "56304.13718779086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q16start", "=", "56305.08740097"}], ";", 
  RowBox[{"Q16end", "=", "56390.96969746"}], ";", 
  RowBox[{"Q17start", "=", "56391"}], ";", 
  RowBox[{"Q17end", "=", "57000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"quack", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Q0start", ",", "Q1end", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q2start", ",", "Q2end", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q3start", ",", "Q3end", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q4start", ",", "Q4end", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q5start", ",", "Q5end", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q6start", ",", "Q6end", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q7start", ",", "Q7end", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q8start", ",", "Q8end", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q9start", ",", "Q9end", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q10start", ",", "Q10end", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q11start", ",", "Q11end", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q12start", ",", "Q12end", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q13start", ",", "Q13end", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q14start", ",", "Q14end", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q15start", ",", "Q15end", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q16start", ",", "Q16end", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q17start", ",", "Q17end", ",", "17"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quarterfind", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"quack", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<", "t", "<", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.789746495586088*^9, 3.789746647392126*^9}, {
   3.7897466981303797`*^9, 3.789746698320208*^9}, 3.789746772661439*^9},
 CellLabel->
  "In[294]:=",ExpressionUUID->"a9058255-8e17-4f72-b948-133f50fa2eda"],

Cell[CellGroupData[{

Cell["start here", "Section",
 CellChangeTimes->{{3.78974648300758*^9, 
  3.789746484041362*^9}},ExpressionUUID->"71544f96-9c9f-4ec9-b191-\
5ffdba05b8e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"thisfolder", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.725717305742607*^9, 3.725717349219287*^9}, {
  3.726486480733694*^9, 3.72648651271693*^9}, {3.726486564108225*^9, 
  3.726486564412117*^9}, {3.726919590777047*^9, 3.72691960475144*^9}, {
  3.7269198458635073`*^9, 3.726919846230658*^9}, {3.741947667725552*^9, 
  3.741947673340198*^9}, {3.7419477290132437`*^9, 3.741947729356859*^9}, {
  3.7670859063322687`*^9, 3.767085915769616*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"9747e039-7f2b-4bcd-a1a6-8cf3e90389ef"],

Cell[BoxData["\<\"/Users/davidkipping/Storage1/Work/Documents/Transit_Work/\
PAPERS/Undersampled/LIGHTCURVES3/SINGLES/KOI-3508.01/planet1/\"\>"], "Output",\

 CellChangeTimes->{
  3.767085915911344*^9, 3.7670880863430862`*^9, 3.767092692768894*^9, {
   3.767092993963686*^9, 3.7670930042495947`*^9}, 3.767094017834442*^9, 
   3.767179926410816*^9, 3.767265842946332*^9, 3.767604413185176*^9, 
   3.7676077114800377`*^9, 3.785582085206008*^9, {3.785691350156448*^9, 
   3.7856913547726*^9}, 3.788279870968204*^9, 3.7882801846879063`*^9, 
   3.788280481253207*^9, 3.788351535685738*^9, 3.7883632574985437`*^9, 
   3.788363401632668*^9, 3.788387891424856*^9, 3.7884330996219463`*^9, 
   3.7884558018341007`*^9, 3.789140381315094*^9, 3.789146703478204*^9, {
   3.789746309952821*^9, 3.789746324972197*^9}, 3.789746841270443*^9, 
   3.790963569245854*^9, 3.792577221897779*^9, 3.802263007212946*^9},
 CellLabel->
  "Out[313]=",ExpressionUUID->"61688168-2fa2-433b-8b62-1532cdd65669"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"type", "=", "\"\<NEA\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"planetnumber", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"Last", "[", 
     RowBox[{"Characters", "[", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"thisfolder", ",", "\"\</\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"StringSplit", "[", 
           RowBox[{"thisfolder", ",", "\"\</\>\""}], "]"}], "]"}], "-", "0"}],
         "]"}], "]"}], "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kic", "=", 
   RowBox[{
    RowBox[{"StringSplit", "[", 
     RowBox[{"thisfolder", ",", "\"\</\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"thisfolder", ",", "\"\</\>\""}], "]"}], "]"}], "-", "1"}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"StringSplit", "[", 
     RowBox[{"thisfolder", ",", "\"\</\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"StringSplit", "[", 
         RowBox[{"thisfolder", ",", "\"\</\>\""}], "]"}], "]"}], "-", "1"}]}],
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "temp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"StringSplit", "[", 
     RowBox[{"thisfolder", ",", "\"\</\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"StringSplit", "[", 
         RowBox[{"thisfolder", ",", "\"\</\>\""}], "]"}], "]"}], "-", "2"}]}],
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"rootfolder", "=", "\"\</\>\""}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"rootfolder", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"rootfolder", ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", "\"\</\>\""}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "temp", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "temp", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.767093857576754*^9, 3.767093858543221*^9}, {
   3.767093889751915*^9, 3.767093906623953*^9}, {3.7670939379462757`*^9, 
   3.767093938551182*^9}, 3.7670940898843107`*^9},
 CellLabel->
  "In[314]:=",ExpressionUUID->"4f49b4ff-9196-41db-be48-b313d44942f8"],

Cell[CellGroupData[{

Cell["compile file names", "Subsection",
 CellChangeTimes->{{3.767093534525024*^9, 
  3.767093538843837*^9}},ExpressionUUID->"24b59279-de38-46c0-8f4d-\
028851c17212"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cofiamfiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"thisfolder", ",", "\"\<SAP/cofiam*.dat\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localfiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"thisfolder", ",", "\"\<SAP/local*.dat\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polyamfiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"thisfolder", ",", "\"\<SAP/polyam*.dat\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpfiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"thisfolder", ",", "\"\<SAP/gp*.dat\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cofiamfiles2", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"thisfolder", ",", "\"\<PDC/cofiam*.dat\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localfiles2", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"thisfolder", ",", "\"\<PDC/local*.dat\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polyamfiles2", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"thisfolder", ",", "\"\<PDC/polyam*.dat\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpfiles2", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"thisfolder", ",", "\"\<PDC/gp*.dat\>\""}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.741947683439713*^9, 3.741947699444231*^9}, {
  3.741947735421186*^9, 3.741947786195876*^9}, {3.741947858828034*^9, 
  3.741947898909079*^9}, {3.767088088170485*^9, 3.767088131324827*^9}, {
  3.767092673714072*^9, 3.76709268153543*^9}, {3.7670927568891497`*^9, 
  3.767092757180869*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"9e82d6c9-037e-49db-8405-5165d04dd674"],

Cell[BoxData[
 RowBox[{
  RowBox[{"epochs", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"cofiamfiles", ",", "\"\<.\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"localfiles", ",", "\"\<.\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"polyamfiles", ",", "\"\<.\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"gpfiles", ",", "\"\<.\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"cofiamfiles2", ",", "\"\<.\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"localfiles2", ",", "\"\<.\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"polyamfiles2", ",", "\"\<.\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"gpfiles2", ",", "\"\<.\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.767092758738673*^9, 3.767092819175905*^9}, {
  3.785582317230812*^9, 3.785582324397369*^9}, {3.7882799110003967`*^9, 
  3.788279913419221*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"820fccb3-0079-4480-8bbb-f371155ce06b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cofiamgiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"thisfolder", ",", "\"\<SAP/cofiamSAP.\>\"", ",", 
       RowBox[{"epochs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<.dat\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localgiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"thisfolder", ",", "\"\<SAP/localSAP.\>\"", ",", 
       RowBox[{"epochs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<.dat\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polyamgiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"thisfolder", ",", "\"\<SAP/polyamSAP.\>\"", ",", 
       RowBox[{"epochs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<.dat\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpgiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"thisfolder", ",", "\"\<SAP/gpSAP.\>\"", ",", 
       RowBox[{"epochs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<.dat\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cofiamgiles2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"thisfolder", ",", "\"\<PDC/cofiamPDC.\>\"", ",", 
       RowBox[{"epochs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<.dat\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localgiles2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"thisfolder", ",", "\"\<PDC/localPDC.\>\"", ",", 
       RowBox[{"epochs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<.dat\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polyamgiles2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"thisfolder", ",", "\"\<PDC/polyamPDC.\>\"", ",", 
       RowBox[{"epochs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<.dat\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpgiles2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"thisfolder", ",", "\"\<PDC/gpPDC.\>\"", ",", 
       RowBox[{"epochs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<.dat\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.767092916928747*^9, 3.767093053744814*^9}, {
  3.788279917647978*^9, 3.7882799206748*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"f52badd7-367a-4d01-a808-7d7c91c11aac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["import SAP", "Subsection",
 CellChangeTimes->{{3.767093517328856*^9, 
  3.767093550340905*^9}},ExpressionUUID->"8bf8f9d0-8206-44ba-9777-\
bc87a8de7228"],

Cell[BoxData[{
 RowBox[{"\"\<cofiam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisfile", "=", 
   RowBox[{"cofiamgiles", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["cofiam", "j"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"thisfile", ",", "\"\<Table\>\""}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["cofiam", "j"], "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670930838758917`*^9, 3.767093442557364*^9}, {
  3.76709352114954*^9, 3.767093524895347*^9}, {3.767093557846385*^9, 
  3.7670935756311283`*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"4d88f69a-79d2-4619-96bf-26e191c46f8b"],

Cell[BoxData[{
 RowBox[{"\"\<local\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisfile", "=", 
   RowBox[{"localgiles", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["local", "j"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"thisfile", ",", "\"\<Table\>\""}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["local", "j"], "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709344826257*^9, 3.767093459004622*^9}, {
  3.767093583205201*^9, 3.767093595262116*^9}},
 CellLabel->
  "In[341]:=",ExpressionUUID->"2e93ba8a-7bee-4051-90ed-a943751c796d"],

Cell[BoxData[{
 RowBox[{"\"\<polyam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisfile", "=", 
   RowBox[{"polyamgiles", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["polyam", "j"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"thisfile", ",", "\"\<Table\>\""}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["polyam", "j"], "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670934632129507`*^9, 3.7670934722240067`*^9}, {
  3.767093598977561*^9, 3.767093608289474*^9}},
 CellLabel->
  "In[343]:=",ExpressionUUID->"827d5e9e-3309-4094-b5e4-e583f6e6f7dc"],

Cell[BoxData[{
 RowBox[{"\"\<gp\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisfile", "=", 
   RowBox[{"gpgiles", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["gp", "j"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"thisfile", ",", "\"\<Table\>\""}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["gp", "j"], "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.767093476375188*^9, 3.767093485891054*^9}, {
  3.767093624929813*^9, 3.767093637473384*^9}},
 CellLabel->
  "In[345]:=",ExpressionUUID->"95ad52ec-2841-471c-9529-6e093a71fccd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["import & correct PDC files", "Subsection",
 CellChangeTimes->{{3.767093517328856*^9, 3.767093519370582*^9}, {
  3.767094008737578*^9, 
  3.767094009659843*^9}},ExpressionUUID->"3f24f731-9743-48cf-926e-\
5d0001a3d9b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"blends", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"thisfolder", ",", "\"\<blends.dat\>\""}], "]"}], ",", 
      "\"\<Table\>\""}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.767604456432261*^9, 3.767604458086608*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"48863379-475e-463e-9994-cff7a7880182"],

Cell[BoxData[{
 RowBox[{"\"\<cofiam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisfile", "=", 
   RowBox[{"cofiamgiles2", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"thisdata", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"thisfile", ",", "\"\<Table\>\""}], "]"}]}], ";", 
  RowBox[{"thisquarter", "=", 
   RowBox[{"quarterfind", "[", 
    RowBox[{"Median", "[", 
     RowBox[{"thisdata", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"thisblend", "=", 
   RowBox[{"1.0", "/", 
    RowBox[{"blends", "[", 
     RowBox[{"[", "thisquarter", "]"}], "]"}]}]}], ";", 
  RowBox[{"newdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"thisdata", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"(", 
          RowBox[{"thisblend", "-", "1"}], ")"}]}], "thisblend"], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["cofiam2", "j"], "=", "newdata"}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["cofiam2", "j"], "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670930838758917`*^9, 3.767093442557364*^9}, {
   3.76709352114954*^9, 3.767093524895347*^9}, 3.785582418664418*^9, 
   3.7882800507916403`*^9, {3.7897467303409224`*^9, 3.789746749812216*^9}},
 CellLabel->
  "In[348]:=",ExpressionUUID->"3d722d60-dd0c-4048-81d5-779f26c79c7f"],

Cell[BoxData[{
 RowBox[{"\"\<local\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisfile", "=", 
   RowBox[{"localgiles2", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"thisdata", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"thisfile", ",", "\"\<Table\>\""}], "]"}]}], ";", 
  RowBox[{"thisquarter", "=", 
   RowBox[{"quarterfind", "[", 
    RowBox[{"Median", "[", 
     RowBox[{"thisdata", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"thisblend", "=", 
   RowBox[{"1.0", "/", 
    RowBox[{"blends", "[", 
     RowBox[{"[", "thisquarter", "]"}], "]"}]}]}], ";", 
  RowBox[{"newdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"thisdata", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"(", 
          RowBox[{"thisblend", "-", "1"}], ")"}]}], "thisblend"], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["local2", "j"], "=", "newdata"}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["local2", "j"], "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709344826257*^9, 3.767093459004622*^9}, 
   3.785582433943078*^9, 3.78828006228825*^9, {3.789746796018564*^9, 
   3.789746797770465*^9}},
 CellLabel->
  "In[350]:=",ExpressionUUID->"1631d968-6c74-44a6-9b22-476ce7c3b505"],

Cell[BoxData[{
 RowBox[{"\"\<polyam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisfile", "=", 
   RowBox[{"polyamgiles2", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"thisdata", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"thisfile", ",", "\"\<Table\>\""}], "]"}]}], ";", 
  RowBox[{"thisquarter", "=", 
   RowBox[{"quarterfind", "[", 
    RowBox[{"Median", "[", 
     RowBox[{"thisdata", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"thisblend", "=", 
   RowBox[{"1.0", "/", 
    RowBox[{"blends", "[", 
     RowBox[{"[", "thisquarter", "]"}], "]"}]}]}], ";", 
  RowBox[{"newdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"thisdata", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"(", 
          RowBox[{"thisblend", "-", "1"}], ")"}]}], "thisblend"], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["polyam2", "j"], "=", "newdata"}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["polyam2", "j"], "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670934632129507`*^9, 3.7670934722240067`*^9}, 
   3.785582438443574*^9, 3.788280065426856*^9, {3.789746805118143*^9, 
   3.789746806286778*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"338e7d52-b107-4094-bb3b-cfb03d853884"],

Cell[BoxData[{
 RowBox[{"\"\<gp\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisfile", "=", 
   RowBox[{"gpgiles2", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"thisdata", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"thisfile", ",", "\"\<Table\>\""}], "]"}]}], ";", 
  RowBox[{"thisquarter", "=", 
   RowBox[{"quarterfind", "[", 
    RowBox[{"Median", "[", 
     RowBox[{"thisdata", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"thisblend", "=", 
   RowBox[{"1.0", "/", 
    RowBox[{"blends", "[", 
     RowBox[{"[", "thisquarter", "]"}], "]"}]}]}], ";", 
  RowBox[{"newdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"thisdata", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"(", 
          RowBox[{"thisblend", "-", "1"}], ")"}]}], "thisblend"], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["gp2", "j"], "=", "newdata"}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "thisfile", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["gp2", "j"], "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.767093476375188*^9, 3.767093485891054*^9}, 
   3.785582441007786*^9, 3.788280069398121*^9, {3.789746815378509*^9, 
   3.78974683441299*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"cc120720-6bb5-49c4-808d-d420353940d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["bin to LC if necessary", "Subsection",
 CellChangeTimes->{{3.767604564881783*^9, 
  3.767604569168138*^9}},ExpressionUUID->"2b4c658e-aeda-4592-9c17-\
f11ddb503599"],

Cell[BoxData[{
 RowBox[{"\"\<cofiam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCcadence", "=", "0.0006811146668042056"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["cofiam", "k"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", 
      RowBox[{"First", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SCcadence", ",", 
           RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"Nearest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SCcadence", ",", 
              RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "thisdata", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
     "\[Equal]", "1"}], ",", 
    RowBox[{"sc", "=", "1"}], ",", 
    RowBox[{"sc", "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endloop", "]"}]}], "]"}], ";", 
  RowBox[{"t0", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"thisdata", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"nice2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Round", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"thisdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "t0"}], "SCcadence"],
          "]"}], "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"m", "=", "0"}], ";", 
  RowBox[{"binsize", "=", "30"}], ";", 
  RowBox[{"jmax", "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"nice2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "/", "binsize"}], 
    "]"}]}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"dummy", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"nice2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "binsize"}], "+", "1"}], 
       "\[LessEqual]", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", 
       RowBox[{"j", " ", "binsize"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{"m", "=", 
     RowBox[{"m", "+", "1"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[Alpha]", "m"], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       SqrtBox[
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]]]}], 
      "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", "jmax"}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";", 
  RowBox[{"nicebin", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Alpha]", "mm"], ",", 
     RowBox[{"{", 
      RowBox[{"mm", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endloop", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "1"}], ",", 
    RowBox[{"thisdata2", "=", "nicebin"}], ",", 
    RowBox[{"thisdata2", "=", "thisdata"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["cofiamX", "k"], "=", "thisdata2"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741856475389593*^9, 3.7418568059303226`*^9}, {
  3.741856892731544*^9, 3.741856966641697*^9}, {3.74185727734553*^9, 
  3.7418573233841352`*^9}, {3.7418577580232286`*^9, 3.741857759941456*^9}, {
  3.76760461084802*^9, 3.767604759941969*^9}, {3.7676048005337887`*^9, 
  3.767604802658185*^9}, {3.767604996395115*^9, 3.767605020775572*^9}, {
  3.767605065873674*^9, 3.767605152147552*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"607958bc-1a3b-4b6d-8c20-6ec3aba19371"],

Cell[BoxData[{
 RowBox[{"\"\<local\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCcadence", "=", "0.0006811146668042056"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["local", "k"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", 
      RowBox[{"First", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SCcadence", ",", 
           RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"Nearest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SCcadence", ",", 
              RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "thisdata", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
     "\[Equal]", "1"}], ",", 
    RowBox[{"sc", "=", "1"}], ",", 
    RowBox[{"sc", "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endloop", "]"}]}], "]"}], ";", 
  RowBox[{"t0", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"thisdata", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"nice2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Round", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"thisdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "t0"}], "SCcadence"],
          "]"}], "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"m", "=", "0"}], ";", 
  RowBox[{"binsize", "=", "30"}], ";", 
  RowBox[{"jmax", "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"nice2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "/", "binsize"}], 
    "]"}]}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"dummy", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"nice2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "binsize"}], "+", "1"}], 
       "\[LessEqual]", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", 
       RowBox[{"j", " ", "binsize"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{"m", "=", 
     RowBox[{"m", "+", "1"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[Alpha]", "m"], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       SqrtBox[
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]]]}], 
      "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", "jmax"}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";", 
  RowBox[{"nicebin", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Alpha]", "mm"], ",", 
     RowBox[{"{", 
      RowBox[{"mm", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endloop", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "1"}], ",", 
    RowBox[{"thisdata2", "=", "nicebin"}], ",", 
    RowBox[{"thisdata2", "=", "thisdata"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["localX", "k"], "=", "thisdata2"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741856475389593*^9, 3.7418568059303226`*^9}, {
  3.741856892731544*^9, 3.741856966641697*^9}, {3.74185727734553*^9, 
  3.7418573233841352`*^9}, {3.7418577580232286`*^9, 3.741857759941456*^9}, {
  3.76760461084802*^9, 3.767604759941969*^9}, {3.7676048005337887`*^9, 
  3.767604802658185*^9}, {3.767604996395115*^9, 3.767605020775572*^9}, {
  3.767605065873674*^9, 3.7676051790344677`*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"7f2c2098-252c-457b-9a80-f8d47ffcd942"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\"\<polyam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCcadence", "=", "0.0006811146668042056"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["polyam", "k"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", 
      RowBox[{"First", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SCcadence", ",", 
           RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"Nearest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SCcadence", ",", 
              RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "thisdata", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
     "\[Equal]", "1"}], ",", 
    RowBox[{"sc", "=", "1"}], ",", 
    RowBox[{"sc", "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endloop", "]"}]}], "]"}], ";", 
  RowBox[{"t0", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"thisdata", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"nice2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Round", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"thisdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "t0"}], "SCcadence"],
          "]"}], "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"m", "=", "0"}], ";", 
  RowBox[{"binsize", "=", "30"}], ";", 
  RowBox[{"jmax", "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"nice2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "/", "binsize"}], 
    "]"}]}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"dummy", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"nice2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "binsize"}], "+", "1"}], 
       "\[LessEqual]", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", 
       RowBox[{"j", " ", "binsize"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{"m", "=", 
     RowBox[{"m", "+", "1"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[Alpha]", "m"], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       SqrtBox[
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]]]}], 
      "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", "jmax"}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";", 
  RowBox[{"nicebin", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Alpha]", "mm"], ",", 
     RowBox[{"{", 
      RowBox[{"mm", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endloop", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "1"}], ",", 
    RowBox[{"thisdata2", "=", "nicebin"}], ",", 
    RowBox[{"thisdata2", "=", "thisdata"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["polyamX", "k"], "=", "thisdata2"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741856475389593*^9, 3.7418568059303226`*^9}, {
  3.741856892731544*^9, 3.741856966641697*^9}, {3.74185727734553*^9, 
  3.7418573233841352`*^9}, {3.7418577580232286`*^9, 3.741857759941456*^9}, {
  3.76760461084802*^9, 3.767604759941969*^9}, {3.7676048005337887`*^9, 
  3.767604802658185*^9}, {3.767604996395115*^9, 3.767605020775572*^9}, {
  3.767605065873674*^9, 3.767605152147552*^9}, {3.767605189948902*^9, 
  3.7676051979681053`*^9}, {3.788280321306798*^9, 3.788280335577697*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"1b68da7b-d787-49fc-b9f1-2dcfab33910a"],

Cell[BoxData[
 TemplateBox[{
  "Nearest", "neard", 
   "\"The default distance function does not give a real numeric distance \
when applied to the point pair \\!\\(\\*RowBox[{\\\"\[Infinity]\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.0006811146668042056`\\\"}]\\).\"", 2, 364, 19, 
   20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789746311586134*^9, 3.789746842121207*^9, 
  3.790963569881134*^9, 3.79257722254416*^9, 3.802263007612598*^9},
 CellLabel->
  "During evaluation of \
In[362]:=",ExpressionUUID->"5ed1765d-ec01-459b-8c47-eb431545b21c"],

Cell[BoxData[
 TemplateBox[{
  "First", "nofirst", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\) has zero length and no first \
element.\"", 2, 364, 20, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789746311586134*^9, 3.789746842121207*^9, 
  3.790963569881134*^9, 3.79257722254416*^9, 3.802263007619295*^9},
 CellLabel->
  "During evaluation of \
In[362]:=",ExpressionUUID->"eb2ea866-84ae-4d90-837a-e4279f24e6af"],

Cell[BoxData[
 TemplateBox[{
  "Nearest", "neard", 
   "\"The default distance function does not give a real numeric distance \
when applied to the point pair \\!\\(\\*RowBox[{\\\"\[Infinity]\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.0006811146668042056`\\\"}]\\).\"", 2, 364, 21, 
   20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789746311586134*^9, 3.789746842121207*^9, 
  3.790963569881134*^9, 3.79257722254416*^9, 3.8022630076229877`*^9},
 CellLabel->
  "During evaluation of \
In[362]:=",ExpressionUUID->"38a09ca4-14a2-42f8-9867-ed961614fa37"],

Cell[BoxData[
 TemplateBox[{
  "First", "nofirst", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\) has zero length and no first \
element.\"", 2, 364, 22, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789746311586134*^9, 3.789746842121207*^9, 
  3.790963569881134*^9, 3.79257722254416*^9, 3.802263007626576*^9},
 CellLabel->
  "During evaluation of \
In[362]:=",ExpressionUUID->"62125060-feaa-4078-bb06-30bbda7fd1f7"],

Cell[BoxData[
 TemplateBox[{
  "Nearest", "neard", 
   "\"The default distance function does not give a real numeric distance \
when applied to the point pair \\!\\(\\*RowBox[{\\\"\[Infinity]\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.0006811146668042056`\\\"}]\\).\"", 2, 364, 23, 
   20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789746311586134*^9, 3.789746842121207*^9, 
  3.790963569881134*^9, 3.79257722254416*^9, 3.802263007630067*^9},
 CellLabel->
  "During evaluation of \
In[362]:=",ExpressionUUID->"4a5fc10d-1d8b-4345-878e-445790150bda"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Nearest\\\", \
\\\"::\\\", \\\"neard\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 364, 24, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789746311586134*^9, 3.789746842121207*^9, 
  3.790963569881134*^9, 3.79257722254416*^9, 3.802263007633688*^9},
 CellLabel->
  "During evaluation of \
In[362]:=",ExpressionUUID->"169e35b5-747f-4235-9356-1525ba8dc098"],

Cell[BoxData[
 TemplateBox[{
  "First", "nofirst", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\) has zero length and no first \
element.\"", 2, 364, 25, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789746311586134*^9, 3.789746842121207*^9, 
  3.790963569881134*^9, 3.79257722254416*^9, 3.802263007637454*^9},
 CellLabel->
  "During evaluation of \
In[362]:=",ExpressionUUID->"2590664f-0f15-4984-8297-272b7735aa07"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"First\\\", \\\"::\\\", \
\\\"nofirst\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 364, 26, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789746311586134*^9, 3.789746842121207*^9, 
  3.790963569881134*^9, 3.79257722254416*^9, 3.8022630076409607`*^9},
 CellLabel->
  "During evaluation of \
In[362]:=",ExpressionUUID->"053e2148-d831-4907-82e4-a968899cf6a9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"\"\<gp\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCcadence", "=", "0.0006811146668042056"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["gp", "k"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", 
      RowBox[{"First", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SCcadence", ",", 
           RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"Nearest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SCcadence", ",", 
              RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "thisdata", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
     "\[Equal]", "1"}], ",", 
    RowBox[{"sc", "=", "1"}], ",", 
    RowBox[{"sc", "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endloop", "]"}]}], "]"}], ";", 
  RowBox[{"t0", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"thisdata", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"nice2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Round", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"thisdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "t0"}], "SCcadence"],
          "]"}], "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"m", "=", "0"}], ";", 
  RowBox[{"binsize", "=", "30"}], ";", 
  RowBox[{"jmax", "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"nice2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "/", "binsize"}], 
    "]"}]}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"dummy", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"nice2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "binsize"}], "+", "1"}], 
       "\[LessEqual]", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", 
       RowBox[{"j", " ", "binsize"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{"m", "=", 
     RowBox[{"m", "+", "1"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[Alpha]", "m"], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       SqrtBox[
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]]]}], 
      "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", "jmax"}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";", 
  RowBox[{"nicebin", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Alpha]", "mm"], ",", 
     RowBox[{"{", 
      RowBox[{"mm", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endloop", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "1"}], ",", 
    RowBox[{"thisdata2", "=", "nicebin"}], ",", 
    RowBox[{"thisdata2", "=", "thisdata"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["gpX", "k"], "=", "thisdata2"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741856475389593*^9, 3.7418568059303226`*^9}, {
  3.741856892731544*^9, 3.741856966641697*^9}, {3.74185727734553*^9, 
  3.7418573233841352`*^9}, {3.7418577580232286`*^9, 3.741857759941456*^9}, {
  3.76760461084802*^9, 3.767604759941969*^9}, {3.7676048005337887`*^9, 
  3.767604802658185*^9}, {3.767604996395115*^9, 3.767605020775572*^9}, {
  3.767605065873674*^9, 3.767605152147552*^9}, {3.7676052112786417`*^9, 
  3.7676052194217777`*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"038884b3-423a-4de1-9578-b3e47c06af27"],

Cell[BoxData[{
 RowBox[{"\"\<cofiam2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCcadence", "=", "0.0006811146668042056"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["cofiam2", "k"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", 
      RowBox[{"First", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SCcadence", ",", 
           RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"Nearest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SCcadence", ",", 
              RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "thisdata", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
     "\[Equal]", "1"}], ",", 
    RowBox[{"sc", "=", "1"}], ",", 
    RowBox[{"sc", "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endloop", "]"}]}], "]"}], ";", 
  RowBox[{"t0", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"thisdata", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"nice2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Round", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"thisdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "t0"}], "SCcadence"],
          "]"}], "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"m", "=", "0"}], ";", 
  RowBox[{"binsize", "=", "30"}], ";", 
  RowBox[{"jmax", "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"nice2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "/", "binsize"}], 
    "]"}]}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"dummy", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"nice2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "binsize"}], "+", "1"}], 
       "\[LessEqual]", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", 
       RowBox[{"j", " ", "binsize"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{"m", "=", 
     RowBox[{"m", "+", "1"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[Alpha]", "m"], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       SqrtBox[
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]]]}], 
      "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", "jmax"}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";", 
  RowBox[{"nicebin", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Alpha]", "mm"], ",", 
     RowBox[{"{", 
      RowBox[{"mm", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endloop", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "1"}], ",", 
    RowBox[{"thisdata2", "=", "nicebin"}], ",", 
    RowBox[{"thisdata2", "=", "thisdata"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["cofiam2X", "k"], "=", "thisdata2"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741856475389593*^9, 3.7418568059303226`*^9}, {
  3.741856892731544*^9, 3.741856966641697*^9}, {3.74185727734553*^9, 
  3.7418573233841352`*^9}, {3.7418577580232286`*^9, 3.741857759941456*^9}, {
  3.76760461084802*^9, 3.767604759941969*^9}, {3.7676048005337887`*^9, 
  3.767604802658185*^9}, {3.767604996395115*^9, 3.767605020775572*^9}, {
  3.767605065873674*^9, 3.767605152147552*^9}, {3.767605264310182*^9, 
  3.767605273184916*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"515c1c55-e858-46d7-add6-f74f2c509004"],

Cell[BoxData[{
 RowBox[{"\"\<local2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCcadence", "=", "0.0006811146668042056"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["local2", "k"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", 
      RowBox[{"First", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SCcadence", ",", 
           RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"Nearest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SCcadence", ",", 
              RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "thisdata", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
     "\[Equal]", "1"}], ",", 
    RowBox[{"sc", "=", "1"}], ",", 
    RowBox[{"sc", "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endloop", "]"}]}], "]"}], ";", 
  RowBox[{"Print", "[", "\"\<h\>\"", "]"}], ";", 
  RowBox[{"t0", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"thisdata", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"nice2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Round", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"thisdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "t0"}], "SCcadence"],
          "]"}], "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"m", "=", "0"}], ";", 
  RowBox[{"binsize", "=", "30"}], ";", 
  RowBox[{"jmax", "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"nice2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "/", "binsize"}], 
    "]"}]}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"dummy", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"nice2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "binsize"}], "+", "1"}], 
       "\[LessEqual]", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", 
       RowBox[{"j", " ", "binsize"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{"m", "=", 
     RowBox[{"m", "+", "1"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[Alpha]", "m"], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       SqrtBox[
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]]]}], 
      "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", "jmax"}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";", 
  RowBox[{"nicebin", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Alpha]", "mm"], ",", 
     RowBox[{"{", 
      RowBox[{"mm", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endloop", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "1"}], ",", 
    RowBox[{"thisdata2", "=", "nicebin"}], ",", 
    RowBox[{"thisdata2", "=", "thisdata"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["local2X", "k"], "=", "thisdata2"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741856475389593*^9, 3.7418568059303226`*^9}, {
  3.741856892731544*^9, 3.741856966641697*^9}, {3.74185727734553*^9, 
  3.7418573233841352`*^9}, {3.7418577580232286`*^9, 3.741857759941456*^9}, {
  3.76760461084802*^9, 3.767604759941969*^9}, {3.7676048005337887`*^9, 
  3.767604802658185*^9}, {3.767604996395115*^9, 3.767605020775572*^9}, {
  3.767605065873674*^9, 3.7676051790344677`*^9}, {3.767605257818722*^9, 
  3.7676052634992447`*^9}, {3.785582538065542*^9, 3.785582542192775*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"3b0883b5-8fd3-4b62-a055-80a3679e7817"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\"\<polyam2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCcadence", "=", "0.0006811146668042056"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["polyam2", "k"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", 
      RowBox[{"First", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SCcadence", ",", 
           RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"Nearest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SCcadence", ",", 
              RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "thisdata", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
     "\[Equal]", "1"}], ",", 
    RowBox[{"sc", "=", "1"}], ",", 
    RowBox[{"sc", "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endloop", "]"}]}], "]"}], ";", 
  RowBox[{"t0", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"thisdata", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"nice2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Round", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"thisdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "t0"}], "SCcadence"],
          "]"}], "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"m", "=", "0"}], ";", 
  RowBox[{"binsize", "=", "30"}], ";", 
  RowBox[{"jmax", "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"nice2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "/", "binsize"}], 
    "]"}]}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"dummy", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"nice2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "binsize"}], "+", "1"}], 
       "\[LessEqual]", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", 
       RowBox[{"j", " ", "binsize"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{"m", "=", 
     RowBox[{"m", "+", "1"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[Alpha]", "m"], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       SqrtBox[
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]]]}], 
      "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", "jmax"}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";", 
  RowBox[{"nicebin", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Alpha]", "mm"], ",", 
     RowBox[{"{", 
      RowBox[{"mm", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endloop", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "1"}], ",", 
    RowBox[{"thisdata2", "=", "nicebin"}], ",", 
    RowBox[{"thisdata2", "=", "thisdata"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["polyam2X", "k"], "=", "thisdata2"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741856475389593*^9, 3.7418568059303226`*^9}, {
  3.741856892731544*^9, 3.741856966641697*^9}, {3.74185727734553*^9, 
  3.7418573233841352`*^9}, {3.7418577580232286`*^9, 3.741857759941456*^9}, {
  3.76760461084802*^9, 3.767604759941969*^9}, {3.7676048005337887`*^9, 
  3.767604802658185*^9}, {3.767604996395115*^9, 3.767605020775572*^9}, {
  3.767605065873674*^9, 3.767605152147552*^9}, {3.767605189948902*^9, 
  3.7676051979681053`*^9}, {3.7676052454543257`*^9, 3.7676052532057858`*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"f5a38373-e6f1-43c0-bf66-8220cdb83004"],

Cell[BoxData[
 TemplateBox[{
  "Nearest", "neard", 
   "\"The default distance function does not give a real numeric distance \
when applied to the point pair \\!\\(\\*RowBox[{\\\"\[Infinity]\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.0006811146668042056`\\\"}]\\).\"", 2, 376, 27, 
   20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789140381990184*^9, 3.7891467047709723`*^9, 
  3.7897463123545713`*^9, 3.789746842419732*^9, 3.790963570108762*^9, 
  3.792577223279015*^9, 3.802263007697092*^9},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"7d3b6733-3ac0-4047-bdf1-8a19b496ffe9"],

Cell[BoxData[
 TemplateBox[{
  "First", "nofirst", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\) has zero length and no first \
element.\"", 2, 376, 28, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789140381990184*^9, 3.7891467047709723`*^9, 
  3.7897463123545713`*^9, 3.789746842419732*^9, 3.790963570108762*^9, 
  3.792577223279015*^9, 3.80226300770188*^9},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"c2bbf98e-8595-4651-8d74-ab8f75c3c3ba"],

Cell[BoxData[
 TemplateBox[{
  "Nearest", "neard", 
   "\"The default distance function does not give a real numeric distance \
when applied to the point pair \\!\\(\\*RowBox[{\\\"\[Infinity]\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.0006811146668042056`\\\"}]\\).\"", 2, 376, 29, 
   20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789140381990184*^9, 3.7891467047709723`*^9, 
  3.7897463123545713`*^9, 3.789746842419732*^9, 3.790963570108762*^9, 
  3.792577223279015*^9, 3.802263007705464*^9},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"938f2446-a7d0-4500-ba35-d44f5ce3d321"],

Cell[BoxData[
 TemplateBox[{
  "First", "nofirst", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\) has zero length and no first \
element.\"", 2, 376, 30, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789140381990184*^9, 3.7891467047709723`*^9, 
  3.7897463123545713`*^9, 3.789746842419732*^9, 3.790963570108762*^9, 
  3.792577223279015*^9, 3.8022630077089987`*^9},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"0c349401-3781-46c2-8c33-e5c5c0866f5c"],

Cell[BoxData[
 TemplateBox[{
  "Nearest", "neard", 
   "\"The default distance function does not give a real numeric distance \
when applied to the point pair \\!\\(\\*RowBox[{\\\"\[Infinity]\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.0006811146668042056`\\\"}]\\).\"", 2, 376, 31, 
   20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789140381990184*^9, 3.7891467047709723`*^9, 
  3.7897463123545713`*^9, 3.789746842419732*^9, 3.790963570108762*^9, 
  3.792577223279015*^9, 3.8022630077124968`*^9},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"e092b123-6850-4110-a226-61d8171e5b61"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Nearest\\\", \
\\\"::\\\", \\\"neard\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 376, 32, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789140381990184*^9, 3.7891467047709723`*^9, 
  3.7897463123545713`*^9, 3.789746842419732*^9, 3.790963570108762*^9, 
  3.792577223279015*^9, 3.802263007716029*^9},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"532d5200-2d0b-4817-be83-4963bd036ee3"],

Cell[BoxData[
 TemplateBox[{
  "First", "nofirst", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\) has zero length and no first \
element.\"", 2, 376, 33, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789140381990184*^9, 3.7891467047709723`*^9, 
  3.7897463123545713`*^9, 3.789746842419732*^9, 3.790963570108762*^9, 
  3.792577223279015*^9, 3.802263007719533*^9},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"06c1317f-dbf8-4606-a2d5-b7565d48a9f4"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"First\\\", \\\"::\\\", \
\\\"nofirst\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 376, 34, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.789140381990184*^9, 3.7891467047709723`*^9, 
  3.7897463123545713`*^9, 3.789746842419732*^9, 3.790963570108762*^9, 
  3.792577223279015*^9, 3.802263007723042*^9},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"e19205a6-0d7d-4626-9443-db37e7249856"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"\"\<gp2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCcadence", "=", "0.0006811146668042056"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["gp2", "k"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", 
      RowBox[{"First", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SCcadence", ",", 
           RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"Nearest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SCcadence", ",", 
              RowBox[{"30", "SCcadence"}]}], "}"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"thisdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "thisdata", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
     "\[Equal]", "1"}], ",", 
    RowBox[{"sc", "=", "1"}], ",", 
    RowBox[{"sc", "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endloop", "]"}]}], "]"}], ";", 
  RowBox[{"t0", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"thisdata", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"nice2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"thisdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Round", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"thisdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "t0"}], "SCcadence"],
          "]"}], "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "thisdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"m", "=", "0"}], ";", 
  RowBox[{"binsize", "=", "30"}], ";", 
  RowBox[{"jmax", "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"nice2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "/", "binsize"}], 
    "]"}]}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"dummy", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"nice2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "binsize"}], "+", "1"}], 
       "\[LessEqual]", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", 
       RowBox[{"j", " ", "binsize"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{"m", "=", 
     RowBox[{"m", "+", "1"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dummy", "]"}], ">", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[Alpha]", "m"], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       FractionBox[
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dummy", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], 
           RowBox[{"-", "2"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]], ",", 
       SqrtBox[
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dummy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], 
            RowBox[{"-", "2"}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dummy", "]"}]}], "}"}]}], "]"}]]]}], 
      "}"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", "jmax"}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";", 
  RowBox[{"nicebin", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Alpha]", "mm"], ",", 
     RowBox[{"{", 
      RowBox[{"mm", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endloop", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sc", "\[Equal]", "1"}], ",", 
    RowBox[{"thisdata2", "=", "nicebin"}], ",", 
    RowBox[{"thisdata2", "=", "thisdata"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["gp2X", "k"], "=", "thisdata2"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741856475389593*^9, 3.7418568059303226`*^9}, {
  3.741856892731544*^9, 3.741856966641697*^9}, {3.74185727734553*^9, 
  3.7418573233841352`*^9}, {3.7418577580232286`*^9, 3.741857759941456*^9}, {
  3.76760461084802*^9, 3.767604759941969*^9}, {3.7676048005337887`*^9, 
  3.767604802658185*^9}, {3.767604996395115*^9, 3.767605020775572*^9}, {
  3.767605065873674*^9, 3.767605152147552*^9}, {3.7676052112786417`*^9, 
  3.767605244880699*^9}},
 CellLabel->
  "In[377]:=",ExpressionUUID->"a5ec8da1-5a2b-43fc-9c09-677babbca91b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["evaluate the DW fitness of each file", "Subsection",
 CellChangeTimes->{{3.767093646921619*^9, 3.767093654650037*^9}, {
  3.767096333324258*^9, 
  3.767096334695882*^9}},ExpressionUUID->"5489413d-a4bd-4c4c-abe9-\
460090baa532"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dw", "[", "list_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "list", "]"}], ">", "1"}], ",", 
     FractionBox[
      RowBox[{"Sum", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}], "2"], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], 
      RowBox[{"Sum", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}], "2"], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]], ",", "2"}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.767093718910576*^9, 3.767093810685794*^9}, {
  3.767094294415844*^9, 3.767094324204647*^9}, {3.767605406003994*^9, 
  3.76760542151475*^9}},
 CellLabel->
  "In[380]:=",ExpressionUUID->"dbdabf07-f391-4f9b-a553-847364b02898"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"infofile", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"rootfolder", ",", "type", ",", "\"\<.csv\>\""}], "]"}], ",", 
      "\"\<CSV\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"19", ";;", "All"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kic2", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{
     RowBox[{"StringSplit", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"Last", "[", 
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"FileNames", "[", 
               RowBox[{"StringJoin", "[", 
                RowBox[{
                 RowBox[{"StringReplace", "[", 
                  RowBox[{
                   RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                   RowBox[{"\"\<planet1\>\"", "\[Rule]", "\"\<RawsLC\>\""}]}],
                   "]"}], ",", "\"\<*.fits\>\""}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\</\>\""}], "]"}], 
           "]"}], ",", "\"\<-\>\""}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<lr\>\""}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"infoline", "=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{"infofile", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "kic2"}], "&"}]}], "]"}], 
   "[", 
   RowBox[{"[", "planetnumber", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"period", "=", 
  RowBox[{"infoline", "[", 
   RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"tau0", "=", 
  RowBox[{
   RowBox[{"infoline", "[", 
    RowBox[{"[", "6", "]"}], "]"}], "+", "54833"}]}], "\[IndentingNewLine]", 
 RowBox[{"\"\<read duration (only for NEA, else you'll need to mannually \
input\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{"duration", "=", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"infoline", "[", 
      RowBox[{"[", "9", "]"}], "]"}], "/", "24"}], "]"}], "+", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"29.4244", "/", "60"}], ")"}], "/", "24"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.785582610045664*^9, 3.785582613026721*^9}, 
   3.78558274175003*^9},
 CellLabel->
  "In[381]:=",ExpressionUUID->"a38b487b-5601-436a-8f97-516dd1ce3d67"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6697817", ",", "\<\"K03508.01\"\>", ",", "190.800788`", ",", "0.002576`", 
   ",", 
   RowBox[{"-", "0.002576`"}], ",", "236.0389`", ",", "0.0103`", ",", 
   RowBox[{"-", "0.0103`"}], ",", "8.082`", ",", "0.352`", ",", 
   RowBox[{"-", "0.352`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7855826152602873`*^9, {3.785582743015004*^9, 3.785582746097163*^9}, 
   3.785691356153502*^9, 3.7882805163083773`*^9, 3.788351538370926*^9, 
   3.788363263260244*^9, 3.7883634042275352`*^9, 3.788387893400488*^9, 
   3.78843310171516*^9, 3.78845580377841*^9, 3.789140383256091*^9, 
   3.789146705454977*^9, 3.789746313635899*^9, 3.789746842892173*^9, 
   3.7909635710151873`*^9, 3.792577224146055*^9, 3.8022630078596087`*^9},
 CellLabel->
  "Out[383]=",ExpressionUUID->"f37f30bb-87a4-42c5-970f-a0d88b90e1f9"],

Cell[BoxData["190.800788`"], "Output",
 CellChangeTimes->{
  3.7855826152602873`*^9, {3.785582743015004*^9, 3.785582746097163*^9}, 
   3.785691356153502*^9, 3.7882805163083773`*^9, 3.788351538370926*^9, 
   3.788363263260244*^9, 3.7883634042275352`*^9, 3.788387893400488*^9, 
   3.78843310171516*^9, 3.78845580377841*^9, 3.789140383256091*^9, 
   3.789146705454977*^9, 3.789746313635899*^9, 3.789746842892173*^9, 
   3.7909635710151873`*^9, 3.792577224146055*^9, 3.802263007861354*^9},
 CellLabel->
  "Out[384]=",ExpressionUUID->"e0185ac4-744d-4b37-ae63-09a400aed8bf"],

Cell[BoxData["55069.0389`"], "Output",
 CellChangeTimes->{
  3.7855826152602873`*^9, {3.785582743015004*^9, 3.785582746097163*^9}, 
   3.785691356153502*^9, 3.7882805163083773`*^9, 3.788351538370926*^9, 
   3.788363263260244*^9, 3.7883634042275352`*^9, 3.788387893400488*^9, 
   3.78843310171516*^9, 3.78845580377841*^9, 3.789140383256091*^9, 
   3.789146705454977*^9, 3.789746313635899*^9, 3.789746842892173*^9, 
   3.7909635710151873`*^9, 3.792577224146055*^9, 3.802263007862651*^9},
 CellLabel->
  "Out[385]=",ExpressionUUID->"4cc004c8-8582-4b5c-8a13-7a34b3af144c"],

Cell[BoxData["0.3571836111111111`"], "Output",
 CellChangeTimes->{
  3.7855826152602873`*^9, {3.785582743015004*^9, 3.785582746097163*^9}, 
   3.785691356153502*^9, 3.7882805163083773`*^9, 3.788351538370926*^9, 
   3.788363263260244*^9, 3.7883634042275352`*^9, 3.788387893400488*^9, 
   3.78843310171516*^9, 3.78845580377841*^9, 3.789140383256091*^9, 
   3.789146705454977*^9, 3.789746313635899*^9, 3.789746842892173*^9, 
   3.7909635710151873`*^9, 3.792577224146055*^9, 3.802263007863953*^9},
 CellLabel->
  "Out[387]=",ExpressionUUID->"8644dfca-e84a-4151-aa6c-36e7144d0487"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"kmax", "=", 
   RowBox[{"10", "^", "4"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.767096527169981*^9, 3.7670965284967833`*^9}, 
   3.767604544339437*^9, 3.7676052878328657`*^9},
 CellLabel->
  "In[388]:=",ExpressionUUID->"ac181a87-4adb-4b88-9a1f-57ba6d9eed4d"],

Cell[CellGroupData[{

Cell["SAP", "Subsubsection",
 CellChangeTimes->{{3.76709668692866*^9, 
  3.767096687186695*^9}},ExpressionUUID->"6564553c-3000-450d-92e5-\
5ec156a15a5f"],

Cell[BoxData[{
 RowBox[{"\"\<cofiam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["cofiamX", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"predata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], "<", 
       RowBox[{
        RowBox[{"-", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"postdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], ">", 
       RowBox[{
        RowBox[{"+", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"dwnative", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"predata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"postdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakepredata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "predata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"fakepostdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "postdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["dwfake", "k"], "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepredata", "]"}], "-", "2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepostdata", "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "kmax"}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";", 
  RowBox[{"dwfakes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dwfake", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["cofiamdw\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["cofiamdw\[Sigma]", "j"], "=", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"InverseErfc", "[", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"dwfakes", ",", 
            RowBox[{
             RowBox[{"#", ">", "dwnative"}], "&"}]}], "]"}], "]"}], "kmax"], 
        "]"}], "]"}]}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670942091021557`*^9, 3.767094278286407*^9}, {
   3.7670944045870867`*^9, 3.767094406936997*^9}, {3.767094717962653*^9, 
   3.767094974107665*^9}, {3.767095013222622*^9, 3.7670950147854033`*^9}, {
   3.767095051573475*^9, 3.767095055656104*^9}, {3.767096379259531*^9, 
   3.7670965327044477`*^9}, {3.767096593917881*^9, 3.767096598832947*^9}, 
   3.76760529295155*^9},
 CellLabel->
  "In[389]:=",ExpressionUUID->"d0dcc8fb-ad9b-472a-89a5-a012bda42dfa"],

Cell[BoxData[{
 RowBox[{"\"\<local\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["localX", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"predata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], "<", 
       RowBox[{
        RowBox[{"-", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"postdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], ">", 
       RowBox[{
        RowBox[{"+", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"dwnative", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"predata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"postdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakepredata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "predata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"fakepostdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "postdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["dwfake", "k"], "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepredata", "]"}], "-", "2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepostdata", "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "kmax"}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";", 
  RowBox[{"dwfakes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dwfake", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["localdw\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["localdw\[Sigma]", "j"], "=", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"InverseErfc", "[", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"dwfakes", ",", 
            RowBox[{
             RowBox[{"#", ">", "dwnative"}], "&"}]}], "]"}], "]"}], "kmax"], 
        "]"}], "]"}]}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670942091021557`*^9, 3.767094278286407*^9}, {
   3.7670944045870867`*^9, 3.767094406936997*^9}, {3.767094717962653*^9, 
   3.767094974107665*^9}, {3.767095013222622*^9, 3.7670950147854033`*^9}, {
   3.767095051573475*^9, 3.767095055656104*^9}, {3.767096379259531*^9, 
   3.7670965327044477`*^9}, {3.767096579493794*^9, 3.76709660997085*^9}, 
   3.767605494696732*^9},
 CellLabel->
  "In[391]:=",ExpressionUUID->"8c0bf51b-2812-4b43-86a1-98864d5b2c96"],

Cell[BoxData[{
 RowBox[{"\"\<polyam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["polyamX", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"predata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], "<", 
       RowBox[{
        RowBox[{"-", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"postdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], ">", 
       RowBox[{
        RowBox[{"+", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"dwnative", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"predata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"postdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakepredata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "predata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"fakepostdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "postdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["dwfake", "k"], "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepredata", "]"}], "-", "2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepostdata", "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "kmax"}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";", 
  RowBox[{"dwfakes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dwfake", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["polyamdw\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["polyamdw\[Sigma]", "j"], "=", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"InverseErfc", "[", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"dwfakes", ",", 
            RowBox[{
             RowBox[{"#", ">", "dwnative"}], "&"}]}], "]"}], "]"}], "kmax"], 
        "]"}], "]"}]}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670942091021557`*^9, 3.767094278286407*^9}, {
   3.7670944045870867`*^9, 3.767094406936997*^9}, {3.767094717962653*^9, 
   3.767094974107665*^9}, {3.767095013222622*^9, 3.7670950147854033`*^9}, {
   3.767095051573475*^9, 3.767095055656104*^9}, {3.767096379259531*^9, 
   3.7670965327044477`*^9}, {3.767096579493794*^9, 3.767096655903328*^9}, 
   3.767605499264003*^9},
 CellLabel->
  "In[393]:=",ExpressionUUID->"0101a4fa-f21d-499a-87f1-d0871438d5b5"],

Cell[BoxData[{
 RowBox[{"\"\<gp\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["gpX", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"predata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], "<", 
       RowBox[{
        RowBox[{"-", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"postdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], ">", 
       RowBox[{
        RowBox[{"+", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"dwnative", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"predata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"postdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakepredata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "predata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"fakepostdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "postdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["dwfake", "k"], "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepredata", "]"}], "-", "2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepostdata", "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "kmax"}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";", 
  RowBox[{"dwfakes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dwfake", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["gpdw\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["gpdw\[Sigma]", "j"], "=", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"InverseErfc", "[", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"dwfakes", ",", 
            RowBox[{
             RowBox[{"#", ">", "dwnative"}], "&"}]}], "]"}], "]"}], "kmax"], 
        "]"}], "]"}]}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670942091021557`*^9, 3.767094278286407*^9}, {
   3.7670944045870867`*^9, 3.767094406936997*^9}, {3.767094717962653*^9, 
   3.767094974107665*^9}, {3.767095013222622*^9, 3.7670950147854033`*^9}, {
   3.767095051573475*^9, 3.767095055656104*^9}, {3.767096379259531*^9, 
   3.7670965327044477`*^9}, {3.767096579493794*^9, 3.76709660997085*^9}, {
   3.7670966653753147`*^9, 3.767096674511798*^9}, 3.767605507645258*^9},
 CellLabel->
  "In[395]:=",ExpressionUUID->"0966e59a-76e5-4818-8e30-4eff11ced549"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PDC", "Subsubsection",
 CellChangeTimes->{{3.76709668692866*^9, 
  3.7670967055352497`*^9}},ExpressionUUID->"73de4e6b-a280-435c-8a64-\
d1697f143e65"],

Cell[BoxData[{
 RowBox[{"\"\<cofiam2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["cofiam2X", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"predata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], "<", 
       RowBox[{
        RowBox[{"-", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"postdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], ">", 
       RowBox[{
        RowBox[{"+", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"dwnative", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"predata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"postdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakepredata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "predata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"fakepostdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "postdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["dwfake", "k"], "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepredata", "]"}], "-", "2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepostdata", "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "kmax"}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";", 
  RowBox[{"dwfakes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dwfake", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["cofiam2dw\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["cofiam2dw\[Sigma]", "j"], "=", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"InverseErfc", "[", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"dwfakes", ",", 
            RowBox[{
             RowBox[{"#", ">", "dwnative"}], "&"}]}], "]"}], "]"}], "kmax"], 
        "]"}], "]"}]}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670942091021557`*^9, 3.767094278286407*^9}, {
   3.7670944045870867`*^9, 3.767094406936997*^9}, {3.767094717962653*^9, 
   3.767094974107665*^9}, {3.767095013222622*^9, 3.7670950147854033`*^9}, {
   3.767095051573475*^9, 3.767095055656104*^9}, {3.767096379259531*^9, 
   3.7670965327044477`*^9}, {3.767096593917881*^9, 3.767096598832947*^9}, {
   3.767096707087476*^9, 3.767096712657312*^9}, 3.7676055271310673`*^9},
 CellLabel->
  "In[397]:=",ExpressionUUID->"586edc56-a802-4bcd-9d8d-63679ceb7eb6"],

Cell[BoxData[{
 RowBox[{"\"\<local2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["local2X", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"predata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], "<", 
       RowBox[{
        RowBox[{"-", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"postdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], ">", 
       RowBox[{
        RowBox[{"+", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"dwnative", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"predata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"postdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakepredata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "predata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"fakepostdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "postdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["dwfake", "k"], "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepredata", "]"}], "-", "2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepostdata", "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "kmax"}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";", 
  RowBox[{"dwfakes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dwfake", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["local2dw\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["local2dw\[Sigma]", "j"], "=", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"InverseErfc", "[", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"dwfakes", ",", 
            RowBox[{
             RowBox[{"#", ">", "dwnative"}], "&"}]}], "]"}], "]"}], "kmax"], 
        "]"}], "]"}]}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670942091021557`*^9, 3.767094278286407*^9}, {
   3.7670944045870867`*^9, 3.767094406936997*^9}, {3.767094717962653*^9, 
   3.767094974107665*^9}, {3.767095013222622*^9, 3.7670950147854033`*^9}, {
   3.767095051573475*^9, 3.767095055656104*^9}, {3.767096379259531*^9, 
   3.7670965327044477`*^9}, {3.767096579493794*^9, 3.76709660997085*^9}, {
   3.7670967153801603`*^9, 3.767096723929957*^9}, 3.767605549888914*^9},
 CellLabel->
  "In[399]:=",ExpressionUUID->"ef6787a2-8f8a-43be-9838-97bf845a517a"],

Cell[BoxData[{
 RowBox[{"\"\<polyam2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["polyam2X", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"predata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], "<", 
       RowBox[{
        RowBox[{"-", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"postdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], ">", 
       RowBox[{
        RowBox[{"+", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"dwnative", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"predata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"postdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakepredata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "predata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"fakepostdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "postdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["dwfake", "k"], "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepredata", "]"}], "-", "2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepostdata", "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "kmax"}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";", 
  RowBox[{"dwfakes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dwfake", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["polyam2dw\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["polyam2dw\[Sigma]", "j"], "=", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"InverseErfc", "[", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"dwfakes", ",", 
            RowBox[{
             RowBox[{"#", ">", "dwnative"}], "&"}]}], "]"}], "]"}], "kmax"], 
        "]"}], "]"}]}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670942091021557`*^9, 3.767094278286407*^9}, {
   3.7670944045870867`*^9, 3.767094406936997*^9}, {3.767094717962653*^9, 
   3.767094974107665*^9}, {3.767095013222622*^9, 3.7670950147854033`*^9}, {
   3.767095051573475*^9, 3.767095055656104*^9}, {3.767096379259531*^9, 
   3.7670965327044477`*^9}, {3.767096579493794*^9, 3.767096655903328*^9}, {
   3.767096725628045*^9, 3.76709673323312*^9}, 3.7676055541978197`*^9},
 CellLabel->
  "In[401]:=",ExpressionUUID->"c23e3e4d-d585-4926-ac46-a21ebd1dda8f"],

Cell[BoxData[{
 RowBox[{"\"\<gp2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["gp2X", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"predata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], "<", 
       RowBox[{
        RowBox[{"-", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"postdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
        RowBox[{"period", " ", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
          "]"}]}]}], ">", 
       RowBox[{
        RowBox[{"+", "duration"}], "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"dwnative", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"predata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", 
         RowBox[{"postdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakepredata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"predata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "predata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"fakepostdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"postdata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "postdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["dwfake", "k"], "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepredata", "]"}], "-", "2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dw", "[", "fakepostdata", "]"}], "-", "2"}], ")"}], 
      "2"]}]]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "kmax"}], ",", 
    RowBox[{"Goto", "[", "kloop", "]"}]}], "]"}], ";", 
  RowBox[{"dwfakes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dwfake", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["gp2dw\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["gp2dw\[Sigma]", "j"], "=", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"InverseErfc", "[", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"dwfakes", ",", 
            RowBox[{
             RowBox[{"#", ">", "dwnative"}], "&"}]}], "]"}], "]"}], "kmax"], 
        "]"}], "]"}]}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7670942091021557`*^9, 3.767094278286407*^9}, {
   3.7670944045870867`*^9, 3.767094406936997*^9}, {3.767094717962653*^9, 
   3.767094974107665*^9}, {3.767095013222622*^9, 3.7670950147854033`*^9}, {
   3.767095051573475*^9, 3.767095055656104*^9}, {3.767096379259531*^9, 
   3.7670965327044477`*^9}, {3.767096579493794*^9, 3.76709660997085*^9}, {
   3.7670966653753147`*^9, 3.767096674511798*^9}, {3.767096738971322*^9, 
   3.767096744764575*^9}, 3.767605559349862*^9},
 CellLabel->
  "In[403]:=",ExpressionUUID->"64a52cd3-92a5-4d5c-9ece-a2a9a7959928"]
}, Open  ]],

Cell[CellGroupData[{

Cell["DW summary", "Subsubsection",
 CellChangeTimes->{{3.767096758151251*^9, 3.76709675889286*^9}, {
  3.767097719551779*^9, 
  3.7670977220368433`*^9}},ExpressionUUID->"c19e8e31-cb1c-4327-bdea-\
9770c2d4a034"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", ",", 
      SubscriptBox["cofiamdw\[Sigma]", "j"], ",", 
      SubscriptBox["localdw\[Sigma]", "j"], ",", 
      SubscriptBox["polyamdw\[Sigma]", "j"], ",", 
      SubscriptBox["gpdw\[Sigma]", "j"], ",", 
      SubscriptBox["cofiam2dw\[Sigma]", "j"], ",", 
      SubscriptBox["local2dw\[Sigma]", "j"], ",", 
      SubscriptBox["polyam2dw\[Sigma]", "j"], ",", 
      SubscriptBox["gp2dw\[Sigma]", "j"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.767096760648634*^9, 3.7670968075722313`*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"ad6bc19a-8200-46cf-bf95-60daca3d0dc3"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "1.6414694675918875`", "1.6521695105991197`", "0", 
     "1.743765434864778`", "1.416941608808903`", "1.3506736395811005`", "0", 
     "1.32853932885681`"},
    {"2", "0.10912921884079906`", "0.38626556555977165`", "0", 
     "1.3957161135566627`", "0.05115752203633167`", "0.38262207516253416`", 
     "0", "0.09527046681226067`"},
    {"3", "0.7035709623985196`", "0.8291845254221186`", "0", 
     "0.8359198403455848`", "0.5462414167578526`", "0.6362706981789833`", "0",
      "0.6431912658037529`"},
    {"4", "0.4312315714786187`", "0.5373874650900955`", "0", 
     "0.5226756299953911`", "0.02343912040324432`", "0.40932659625114726`", 
     "0", "0.3979052906536941`"},
    {"5", "0.7447878186993755`", "1.5228349643880885`", "0", 
     "1.1280471668383576`", "0.05228701461508424`", "1.7141564320035072`", 
     "0", "1.3091014150642146`"},
    {"6", "0.09061312826802291`", "0.8288310776644996`", "0", 
     "0.8394800138278186`", "0.4272462194602629`", "0.789876323271569`", "0", 
     "0.9268585128160439`"},
    {"7", "0.479616656884161`", "0.4469654583680187`", "0", 
     "0.2715084520178387`", "0.44932115383725113`", "0.21508634484542632`", 
     "0", "0.39519362107231837`"}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.767096847264574*^9, 3.7671818700840397`*^9, 
  3.767267878369857*^9, 3.7676057681489973`*^9, 3.7676080919394503`*^9, 
  3.7855834566211863`*^9, 3.785692046924807*^9, 3.7882828621642647`*^9, 
  3.788353799972213*^9, 3.7883656530830727`*^9, 3.7883901635467*^9, 
  3.788434471799184*^9, 3.788457219204833*^9, 3.789140626363976*^9, 
  3.7891471891893272`*^9, 3.7897478946148443`*^9, 3.7909642987604103`*^9, 
  3.792577860465554*^9, 3.80226332085496*^9},
 CellLabel->
  "Out[405]//TableForm=",ExpressionUUID->"d45d3f00-d826-4491-b392-\
af19b4b9e4dc"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["evaluate binning fitness of each file", "Subsection",
 CellChangeTimes->{{3.767096347910955*^9, 
  3.76709635619394*^9}},ExpressionUUID->"04a4ed69-daca-4e49-a1b2-\
4d2637101cbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"monte", "=", 
   RowBox[{"10", "^", "3"}]}], ";"}]], "Input",
 CellLabel->
  "In[406]:=",ExpressionUUID->"1a8c6145-84dd-494c-a6a4-0b2a75434c0a"],

Cell[CellGroupData[{

Cell["SAP", "Subsubsection",
 CellChangeTimes->{{3.7670975270885487`*^9, 
  3.767097527391918*^9}},ExpressionUUID->"a6b47c91-23f6-44f8-89f9-\
f288435a5ea0"],

Cell[BoxData[{
 RowBox[{"\"\<cofiam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["cofiamX", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"outdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
         RowBox[{"period", " ", 
          RowBox[{"Round", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
           "]"}]}]}], "]"}], ">", 
       RowBox[{"duration", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"bmax", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Length", "[", "outdata", "]"}], "/", "3"}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop1", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"outdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop1", "]"}]}], "]"}], ";", 
  RowBox[{"binningpattern", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "binningpattern", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{"realgradient", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop1", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakeoutdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "outdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop2", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"fakeoutdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop2", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["montetab", "k"], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "bmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["montegradient", "k"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "monte"}], ",", 
    RowBox[{"Goto", "[", "kloop1", "]"}]}], "]"}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop3", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["montetab", "k"], "[", 
      RowBox[{"[", 
       RowBox[{"b", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Gamma]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Median", "[", "temp", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop3", "]"}]}], "]"}], ";", 
  RowBox[{"quantiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Gamma]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"montegradients", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["montegradient", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"probs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "3", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop2", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"bracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "realgradient", "<", 
     RowBox[{"bracket", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "1"}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "probs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop2", "]"}]}], "]"}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"probs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       SubscriptBox["pass", "k"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "probs", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["cofiambin\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["cofiambin\[Sigma]", "j"], "=", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
    "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709508854494*^9, 3.767095336656252*^9}, {
   3.767095704402721*^9, 3.767095755049427*^9}, {3.767096013379925*^9, 
   3.767096037622858*^9}, {3.767096903841036*^9, 3.76709696537294*^9}, 
   3.767097028184272*^9, {3.767097208056033*^9, 3.7670972085826*^9}, {
   3.76709733270413*^9, 3.767097472753129*^9}, {3.767097512973665*^9, 
   3.767097518316537*^9}, 3.767605804462625*^9},
 CellLabel->
  "In[407]:=",ExpressionUUID->"dbb69cf5-6b73-4aed-a4f6-3f0203d9df91"],

Cell[BoxData[{
 RowBox[{"\"\<local\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["localX", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"outdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
         RowBox[{"period", " ", 
          RowBox[{"Round", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
           "]"}]}]}], "]"}], ">", 
       RowBox[{"duration", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"bmax", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Length", "[", "outdata", "]"}], "/", "3"}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop1", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"outdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop1", "]"}]}], "]"}], ";", 
  RowBox[{"binningpattern", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "binningpattern", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{"realgradient", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop1", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakeoutdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "outdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop2", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"fakeoutdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop2", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["montetab", "k"], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "bmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["montegradient", "k"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "monte"}], ",", 
    RowBox[{"Goto", "[", "kloop1", "]"}]}], "]"}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop3", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["montetab", "k"], "[", 
      RowBox[{"[", 
       RowBox[{"b", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Gamma]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Median", "[", "temp", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop3", "]"}]}], "]"}], ";", 
  RowBox[{"quantiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Gamma]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"montegradients", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["montegradient", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"probs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "3", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop2", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"bracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "realgradient", "<", 
     RowBox[{"bracket", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "1"}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "probs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop2", "]"}]}], "]"}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"probs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       SubscriptBox["pass", "k"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "probs", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["localbin\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["localbin\[Sigma]", "j"], "=", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
    "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709508854494*^9, 3.767095336656252*^9}, {
   3.767095704402721*^9, 3.767095755049427*^9}, {3.767096013379925*^9, 
   3.767096037622858*^9}, {3.767096903841036*^9, 3.76709696537294*^9}, 
   3.767097028184272*^9, {3.767097208056033*^9, 3.7670972085826*^9}, {
   3.76709733270413*^9, 3.767097472753129*^9}, {3.767097512973665*^9, 
   3.767097549903091*^9}, 3.767605856966509*^9},
 CellLabel->
  "In[409]:=",ExpressionUUID->"18b26aa7-3279-471e-aac9-89956248849e"],

Cell[BoxData[{
 RowBox[{"\"\<polyam\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["polyamX", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"outdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
         RowBox[{"period", " ", 
          RowBox[{"Round", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
           "]"}]}]}], "]"}], ">", 
       RowBox[{"duration", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"bmax", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Length", "[", "outdata", "]"}], "/", "3"}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop1", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"outdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop1", "]"}]}], "]"}], ";", 
  RowBox[{"binningpattern", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "binningpattern", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{"realgradient", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop1", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakeoutdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "outdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop2", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"fakeoutdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop2", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["montetab", "k"], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "bmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["montegradient", "k"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "monte"}], ",", 
    RowBox[{"Goto", "[", "kloop1", "]"}]}], "]"}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop3", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["montetab", "k"], "[", 
      RowBox[{"[", 
       RowBox[{"b", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Gamma]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Median", "[", "temp", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop3", "]"}]}], "]"}], ";", 
  RowBox[{"quantiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Gamma]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"montegradients", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["montegradient", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"probs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "3", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop2", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"bracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "realgradient", "<", 
     RowBox[{"bracket", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "1"}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "probs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop2", "]"}]}], "]"}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"probs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       SubscriptBox["pass", "k"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "probs", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["polyambin\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["polyambin\[Sigma]", "j"], "=", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
    "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709508854494*^9, 3.767095336656252*^9}, {
   3.767095704402721*^9, 3.767095755049427*^9}, {3.767096013379925*^9, 
   3.767096037622858*^9}, {3.767096903841036*^9, 3.76709696537294*^9}, 
   3.767097028184272*^9, {3.767097208056033*^9, 3.7670972085826*^9}, {
   3.76709733270413*^9, 3.767097472753129*^9}, {3.767097512973665*^9, 
   3.767097518316537*^9}, {3.767097556002222*^9, 3.7670975694442863`*^9}, 
   3.767605889760056*^9},
 CellLabel->
  "In[411]:=",ExpressionUUID->"9ada7ea4-29df-4b5f-a4ee-380c7aed600d"],

Cell[BoxData[{
 RowBox[{"\"\<gp\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["gpX", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"outdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
         RowBox[{"period", " ", 
          RowBox[{"Round", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
           "]"}]}]}], "]"}], ">", 
       RowBox[{"duration", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"bmax", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Length", "[", "outdata", "]"}], "/", "3"}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop1", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"outdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop1", "]"}]}], "]"}], ";", 
  RowBox[{"binningpattern", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "binningpattern", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{"realgradient", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop1", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakeoutdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "outdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop2", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"fakeoutdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop2", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["montetab", "k"], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "bmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["montegradient", "k"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "monte"}], ",", 
    RowBox[{"Goto", "[", "kloop1", "]"}]}], "]"}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop3", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["montetab", "k"], "[", 
      RowBox[{"[", 
       RowBox[{"b", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Gamma]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Median", "[", "temp", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop3", "]"}]}], "]"}], ";", 
  RowBox[{"quantiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Gamma]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"montegradients", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["montegradient", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"probs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "3", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop2", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"bracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "realgradient", "<", 
     RowBox[{"bracket", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "1"}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "probs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop2", "]"}]}], "]"}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"probs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       SubscriptBox["pass", "k"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "probs", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["gpbin\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["gpbin\[Sigma]", "j"], "=", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
    "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709508854494*^9, 3.767095336656252*^9}, {
   3.767095704402721*^9, 3.767095755049427*^9}, {3.767096013379925*^9, 
   3.767096037622858*^9}, {3.767096903841036*^9, 3.76709696537294*^9}, 
   3.767097028184272*^9, {3.767097208056033*^9, 3.7670972085826*^9}, {
   3.76709733270413*^9, 3.767097472753129*^9}, {3.767097512973665*^9, 
   3.767097518316537*^9}, {3.767097577669437*^9, 3.767097589097818*^9}, 
   3.76760589813216*^9},
 CellLabel->
  "In[413]:=",ExpressionUUID->"8cbe16bb-97d3-493b-96b0-18390761e598"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PDC", "Subsubsection",
 CellChangeTimes->{{3.7670975270885487`*^9, 3.767097527391918*^9}, {
  3.767097612125455*^9, 
  3.767097612463139*^9}},ExpressionUUID->"b3b8a836-86b7-4c8b-bcb1-\
2c6c0f38f505"],

Cell[BoxData[{
 RowBox[{"\"\<cofiam2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["cofiam2X", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"outdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
         RowBox[{"period", " ", 
          RowBox[{"Round", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
           "]"}]}]}], "]"}], ">", 
       RowBox[{"duration", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"bmax", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Length", "[", "outdata", "]"}], "/", "3"}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop1", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"outdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop1", "]"}]}], "]"}], ";", 
  RowBox[{"binningpattern", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "binningpattern", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{"realgradient", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop1", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakeoutdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "outdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop2", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"fakeoutdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop2", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["montetab", "k"], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "bmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["montegradient", "k"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "monte"}], ",", 
    RowBox[{"Goto", "[", "kloop1", "]"}]}], "]"}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop3", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["montetab", "k"], "[", 
      RowBox[{"[", 
       RowBox[{"b", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Gamma]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Median", "[", "temp", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop3", "]"}]}], "]"}], ";", 
  RowBox[{"quantiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Gamma]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"montegradients", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["montegradient", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"probs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "3", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop2", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"bracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "realgradient", "<", 
     RowBox[{"bracket", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "1"}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "probs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop2", "]"}]}], "]"}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"probs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       SubscriptBox["pass", "k"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "probs", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["cofiam2bin\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["cofiam2bin\[Sigma]", "j"], "=", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
    "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709508854494*^9, 3.767095336656252*^9}, {
   3.767095704402721*^9, 3.767095755049427*^9}, {3.767096013379925*^9, 
   3.767096037622858*^9}, {3.767096903841036*^9, 3.76709696537294*^9}, 
   3.767097028184272*^9, {3.767097208056033*^9, 3.7670972085826*^9}, {
   3.76709733270413*^9, 3.767097472753129*^9}, {3.767097512973665*^9, 
   3.767097518316537*^9}, {3.767097614163479*^9, 3.767097624301608*^9}, 
   3.7676059038450813`*^9},
 CellLabel->
  "In[415]:=",ExpressionUUID->"6550ae81-26a9-43c9-82a7-44c9aa4f00d5"],

Cell[BoxData[{
 RowBox[{"\"\<local2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["local2X", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"outdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
         RowBox[{"period", " ", 
          RowBox[{"Round", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
           "]"}]}]}], "]"}], ">", 
       RowBox[{"duration", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"bmax", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Length", "[", "outdata", "]"}], "/", "3"}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop1", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"outdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop1", "]"}]}], "]"}], ";", 
  RowBox[{"binningpattern", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "binningpattern", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{"realgradient", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop1", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakeoutdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "outdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop2", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"fakeoutdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop2", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["montetab", "k"], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "bmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["montegradient", "k"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "monte"}], ",", 
    RowBox[{"Goto", "[", "kloop1", "]"}]}], "]"}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop3", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["montetab", "k"], "[", 
      RowBox[{"[", 
       RowBox[{"b", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Gamma]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Median", "[", "temp", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop3", "]"}]}], "]"}], ";", 
  RowBox[{"quantiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Gamma]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"montegradients", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["montegradient", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"probs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "3", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop2", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"bracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "realgradient", "<", 
     RowBox[{"bracket", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "1"}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "probs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop2", "]"}]}], "]"}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"probs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       SubscriptBox["pass", "k"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "probs", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["local2bin\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["local2bin\[Sigma]", "j"], "=", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
    "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709508854494*^9, 3.767095336656252*^9}, {
   3.767095704402721*^9, 3.767095755049427*^9}, {3.767096013379925*^9, 
   3.767096037622858*^9}, {3.767096903841036*^9, 3.76709696537294*^9}, 
   3.767097028184272*^9, {3.767097208056033*^9, 3.7670972085826*^9}, {
   3.76709733270413*^9, 3.767097472753129*^9}, {3.767097512973665*^9, 
   3.767097549903091*^9}, {3.767097626212668*^9, 3.7670976374637623`*^9}, 
   3.7676059093125143`*^9},
 CellLabel->
  "In[417]:=",ExpressionUUID->"bf65bf64-d0cc-4f8c-91b6-3aa2273be23f"],

Cell[BoxData[{
 RowBox[{"\"\<polyam2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["polyam2X", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"outdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
         RowBox[{"period", " ", 
          RowBox[{"Round", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
           "]"}]}]}], "]"}], ">", 
       RowBox[{"duration", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"bmax", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Length", "[", "outdata", "]"}], "/", "3"}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop1", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"outdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop1", "]"}]}], "]"}], ";", 
  RowBox[{"binningpattern", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "binningpattern", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{"realgradient", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop1", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakeoutdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "outdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop2", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"fakeoutdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop2", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["montetab", "k"], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "bmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["montegradient", "k"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "monte"}], ",", 
    RowBox[{"Goto", "[", "kloop1", "]"}]}], "]"}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop3", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["montetab", "k"], "[", 
      RowBox[{"[", 
       RowBox[{"b", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Gamma]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Median", "[", "temp", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop3", "]"}]}], "]"}], ";", 
  RowBox[{"quantiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Gamma]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"montegradients", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["montegradient", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"probs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "3", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop2", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"bracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "realgradient", "<", 
     RowBox[{"bracket", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "1"}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "probs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop2", "]"}]}], "]"}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"probs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       SubscriptBox["pass", "k"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "probs", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["polyam2bin\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["polyam2bin\[Sigma]", "j"], "=", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
    "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709508854494*^9, 3.767095336656252*^9}, {
   3.767095704402721*^9, 3.767095755049427*^9}, {3.767096013379925*^9, 
   3.767096037622858*^9}, {3.767096903841036*^9, 3.76709696537294*^9}, 
   3.767097028184272*^9, {3.767097208056033*^9, 3.7670972085826*^9}, {
   3.76709733270413*^9, 3.767097472753129*^9}, {3.767097512973665*^9, 
   3.767097518316537*^9}, {3.767097556002222*^9, 3.7670975694442863`*^9}, {
   3.7670976388919783`*^9, 3.767097649937612*^9}, 3.76760591393648*^9},
 CellLabel->
  "In[419]:=",ExpressionUUID->"3c02ebe0-6869-4a5c-8b8e-557a7b1f16ac"],

Cell[BoxData[{
 RowBox[{"\"\<gp2\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisdata", "=", 
   SubscriptBox["gp2X", "j"]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"Goto", "[", "endbit", "]"}]}], "]"}], ";", 
  RowBox[{"outdata", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"thisdata", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "tau0", "-", 
         RowBox[{"period", " ", 
          RowBox[{"Round", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "tau0"}], "period"], 
           "]"}]}]}], "]"}], ">", 
       RowBox[{"duration", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"bmax", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Length", "[", "outdata", "]"}], "/", "3"}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop1", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"outdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop1", "]"}]}], "]"}], ";", 
  RowBox[{"binningpattern", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"binningpattern", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "binningpattern", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{"realgradient", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop1", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"fakeoutdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"outdata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"outdata", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "outdata", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop2", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Beta]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"fakeoutdata", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "-", "1"}], ")"}], "b"}]}], ",", 
             RowBox[{"l", " ", "b"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Length", "[", "outdata", "]"}], "/", "b"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop2", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["montetab", "k"], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Beta]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"linfit", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["montetab", "k"], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "bmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["montegradient", "k"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"linfit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", "monte"}], ",", 
    RowBox[{"Goto", "[", "kloop1", "]"}]}], "]"}], ";", 
  RowBox[{"b", "=", "0"}], ";", 
  RowBox[{"Label", "[", "bloop3", "]"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"b", "+", "1"}]}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["montetab", "k"], "[", 
      RowBox[{"[", 
       RowBox[{"b", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Gamma]", "b"], "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Median", "[", "temp", "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{"2", "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", "<", "bmax"}], ",", 
    RowBox[{"Goto", "[", "bloop3", "]"}]}], "]"}], ";", 
  RowBox[{"quantiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Gamma]", "b"], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "bmax"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"montegradients", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["montegradient", "k"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "monte"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"probs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "3", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"Label", "[", "kloop2", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"bracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "-", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"Quantile", "[", 
      RowBox[{"montegradients", ",", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", 
         RowBox[{"Erf", "[", 
          RowBox[{
           RowBox[{"probs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "/", 
           SqrtBox["2"]}], "]"}]}]}]}], "]"}]}], "}"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "realgradient", "<", 
     RowBox[{"bracket", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "1"}], ",", 
    RowBox[{
     SubscriptBox["pass", "k"], "=", "0"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", "probs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "kloop2", "]"}]}], "]"}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"probs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       SubscriptBox["pass", "k"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "probs", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Label", "[", "endbit", "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "thisdata", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     SubscriptBox["gp2bin\[Sigma]", "j"], "=", "0"}], ",", 
    RowBox[{
     SubscriptBox["gp2bin\[Sigma]", "j"], "=", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"temp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
    "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.76709508854494*^9, 3.767095336656252*^9}, {
   3.767095704402721*^9, 3.767095755049427*^9}, {3.767096013379925*^9, 
   3.767096037622858*^9}, {3.767096903841036*^9, 3.76709696537294*^9}, 
   3.767097028184272*^9, {3.767097208056033*^9, 3.7670972085826*^9}, {
   3.76709733270413*^9, 3.767097472753129*^9}, {3.767097512973665*^9, 
   3.767097518316537*^9}, {3.767097577669437*^9, 3.767097589097818*^9}, {
   3.76709766569759*^9, 3.767097674574771*^9}, 3.7676059183238983`*^9},
 CellLabel->
  "In[421]:=",ExpressionUUID->"5112694b-7432-4d7a-ab28-8d56472c454f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["binning summary", "Subsubsection",
 CellChangeTimes->{{3.767096758151251*^9, 3.76709675889286*^9}, {
  3.767097719551779*^9, 3.7670977220368433`*^9}, {3.767097758848529*^9, 
  3.767097761152566*^9}},ExpressionUUID->"fc4aed7b-3ace-47b8-bb70-\
4ed261d2c7af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", ",", 
      SubscriptBox["cofiambin\[Sigma]", "j"], ",", 
      SubscriptBox["localbin\[Sigma]", "j"], ",", 
      SubscriptBox["polyambin\[Sigma]", "j"], ",", 
      SubscriptBox["gpbin\[Sigma]", "j"], ",", 
      SubscriptBox["cofiam2bin\[Sigma]", "j"], ",", 
      SubscriptBox["local2bin\[Sigma]", "j"], ",", 
      SubscriptBox["polyam2bin\[Sigma]", "j"], ",", 
      SubscriptBox["gp2bin\[Sigma]", "j"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.767096760648634*^9, 3.7670968075722313`*^9}, {
  3.767097735538999*^9, 3.767097747712434*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"e3c107d3-a974-43a5-860e-cc443c704c19"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "0.45`", "0.8500000000000001`", "0", "0.05`", 
     "0.35000000000000003`", "1.05`", "0", "1.05`"},
    {"2", "1.1500000000000001`", "0.45`", "0", "0.6500000000000001`", 
     "0.8500000000000001`", "0.45`", "0", "0.95`"},
    {"3", "0.15000000000000002`", "0.05`", "0", "0.05`", 
     "0.35000000000000003`", "0.05`", "0", "0.15000000000000002`"},
    {"4", "0.45`", "1.05`", "0", "0.95`", "0.35000000000000003`", "1.75`", 
     "0", "1.6500000000000001`"},
    {"5", "0.95`", "2.55`", "0", "0.6500000000000001`", "1.05`", "0.75`", "0",
      "0.25`"},
    {"6", "0.45`", "0.45`", "0", "0.95`", "1.35`", "0.8500000000000001`", "0",
      "2.75`"},
    {"7", "0.05`", "0.55`", "0", "0.75`", "0.05`", "0.25`", "0", "0.55`"}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.767096847264574*^9, 3.76709778715648*^9, 3.76744652433779*^9, 
   3.767606064087015*^9, 3.767608511512085*^9, {3.7855840256206303`*^9, 
   3.785584050731142*^9}, 3.785692549502109*^9, 3.788284791016122*^9, 
   3.7883557050262947`*^9, 3.788367354587853*^9, 3.7883918861752377`*^9, 
   3.7884354267254972`*^9, 3.788458331511424*^9, 3.78914082826829*^9, 
   3.789147589125608*^9, 3.789748877536749*^9, 3.7909649030139017`*^9, 
   3.7925783877874804`*^9, 3.8022635646014557`*^9},
 CellLabel->
  "Out[423]//TableForm=",ExpressionUUID->"e67b9d8b-2d86-4b74-91d2-\
517472a8ec8e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["determine all times", "Subsection",
 CellChangeTimes->{{3.7670936720319557`*^9, 3.767093672345726*^9}, {
  3.767098092602623*^9, 
  3.7670980960737762`*^9}},ExpressionUUID->"433d1cbb-6655-477a-aa8d-\
b13bf0d2b475"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dw\[Sigma]cutoff", "=", "2"}], ";", 
  RowBox[{"bin\[Sigma]cutoff", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["times", "j"], "=", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["cofiam", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["local", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["polyam", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["gp", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["cofiam2", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["local2", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["polyam2", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["gp2", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["powerlist", "j"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["cofiam", "j"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["cofiamdw\[Sigma]", "j"], ",", 
         SubscriptBox["cofiambin\[Sigma]", "j"], ",", 
         RowBox[{"Length", "[", 
          SubscriptBox["cofiam", "j"], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["local", "j"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["localdw\[Sigma]", "j"], ",", 
         SubscriptBox["localbin\[Sigma]", "j"], ",", 
         RowBox[{"Length", "[", 
          SubscriptBox["local", "j"], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["polyam", "j"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["polyamdw\[Sigma]", "j"], ",", 
         SubscriptBox["polyambin\[Sigma]", "j"], ",", 
         RowBox[{"Length", "[", 
          SubscriptBox["polyam", "j"], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["gp", "j"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["gpdw\[Sigma]", "j"], ",", 
         SubscriptBox["gpbin\[Sigma]", "j"], ",", 
         RowBox[{"Length", "[", 
          SubscriptBox["gp", "j"], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["cofiam2", "j"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["cofiam2dw\[Sigma]", "j"], ",", 
         SubscriptBox["cofiam2bin\[Sigma]", "j"], ",", 
         RowBox[{"Length", "[", 
          SubscriptBox["cofiam", "j"], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["local2", "j"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["local2dw\[Sigma]", "j"], ",", 
         SubscriptBox["local2bin\[Sigma]", "j"], ",", 
         RowBox[{"Length", "[", 
          SubscriptBox["local", "j"], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["polyam2", "j"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["polyam2dw\[Sigma]", "j"], ",", 
         SubscriptBox["polyam2bin\[Sigma]", "j"], ",", 
         RowBox[{"Length", "[", 
          SubscriptBox["polyam", "j"], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["gp2", "j"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["gp2dw\[Sigma]", "j"], ",", 
         SubscriptBox["gp2bin\[Sigma]", "j"], ",", 
         RowBox[{"Length", "[", 
          SubscriptBox["gp2", "j"], "]"}]}], "}"}]}], "}"}]}], "}"}]}], ";", 
  RowBox[{
   SubscriptBox["powerlist", "j"], "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      SubscriptBox["powerlist", "j"], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<", "dw\[Sigma]cutoff"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "<", "bin\[Sigma]cutoff"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Dimensions", "[", 
     SubscriptBox["powerlist", "j"], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.74194798721134*^9, 3.741948300273312*^9}, {
   3.741951234346541*^9, 3.741951288562213*^9}, 3.74195821860676*^9, {
   3.76709819053791*^9, 3.767098216921424*^9}, {3.767098385523302*^9, 
   3.767098411554316*^9}, {3.7670985734069033`*^9, 3.767098586498229*^9}, {
   3.767098634323572*^9, 3.767098634526187*^9}, {3.767098847857732*^9, 
   3.767098850106656*^9}, {3.767099306272275*^9, 3.767099371141217*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"9ab45b4f-719a-4063-aed5-37f9f64400db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "6", ",", "6", ",", "6", ",", "5", ",", "5", ",", "6"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.767098634904875*^9, 3.767098850865321*^9, 
  3.767099373055766*^9, 3.767446524396323*^9, 3.7674474000397577`*^9, 
  3.767606113852147*^9, 3.7676085115821447`*^9, 3.785584054128338*^9, 
  3.785692549550324*^9, 3.7882847910782547`*^9, 3.788355705071767*^9, 
  3.788367354622119*^9, 3.7883918862147493`*^9, 3.788435426769359*^9, 
  3.788458331571033*^9, 3.789140828311428*^9, 3.7891475891743383`*^9, 
  3.789748877665468*^9, 3.790964903058792*^9, 3.7925783878411713`*^9, 
  3.802263564663282*^9},
 CellLabel->
  "Out[426]=",ExpressionUUID->"7c802fc5-ddaf-4a74-a28a-aaf9a52bf1a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["powerlist", "j"], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["powerlist", "j"], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.788344232615765*^9, 3.7883442609260798`*^9}},
 CellLabel->
  "In[427]:=",ExpressionUUID->"1fbc9d96-d67f-4cf4-b961-a6ab220fb23b"],

Cell[BoxData[
 GraphicsBox[{{}, {{
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.007333333333333334],
       AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwV1nk4VV0bBvCjDKVeSulLQiUVReNnLJRIKEIZypDCEclQmc4xxSklU8pY
mUUZIkNUxhAqiQwVFSH1RoYm1Hs/f7hcv+te63n2Xnvttc9Km1OGtrMYDMZ9
/NH/ecOflxpe/KxukGyT3fBnRM19kWElOeprWIkYY1RtF1+pvRE8WPUwrx/+
sElc0BjeciP34aa/I2rKI+eKyVajeR6isNI/BjyHYFenN6E6XKNqXU1Fd8jl
jIudOaivXilqbAJr2rXscUDuORwwRU4z+bvfAvWtswZTTGGHhE8tehi/4MY+
HTO4J+fv3EOoH95Q+I1cWhrq5wTXnxeJM4ezBwWuSqCec4Gf+mHqN0eT+Rn5
K9ePg+Q1fR5zE1GP1143/AjcqcdKXot+M5F35S1gf//FUX4YX3Tgfz1kyXXN
lVWw7B52sCU84tnLvwt2cuvbYAUPWVxbWAwvZ+5tI3OPcdyV4TcWeT7WsFgr
g/85+pUbCUsehWs/88+fj36Fe30ayRaLImW1Mb5c7b2rDbxWcHb9B/jD//eI
HIP/eh5O5MX4VRtyKsna+vM2HUW9LaaLmMfh3E67iCGM/7TUS9AW1vvIl3gG
ubRmbzGZ3cB9rxz5ExVNSzu4qF5I/t+ZEbWW6Wwee1hJT0ycD1Zf4WHMhIsl
rVf8wfiY92+myH0vPJISpkfU7AU0Uh3gY7Vc9+txPTE8WTonYLkYSyMbWL5e
YIz8MOqjVDi8f+J0nCM8r+ruhh48j2efu9Wd4DzLtMxSXJ9tn/oQ+TQn/rIw
LPw6I/wkrP9LQN8O/d+2zldwhhW4x9tWot6DRrcecgGjJWP7LLi6M/gUvEHQ
K1AEeXOZqqwLPBmS+bEFHi9IayPzGL9TGoBVbvOzXGH+bpHybtrPXS6SbvDm
Alf+DJg/8VUjmSEh2ETrGRW93c0d1olb7eU1NaKWXD6n6jScr9OoSM/3ia8z
8wzNzxHY/JX2a06b4Fm4RbV/ozvuh5mhXEKuygpT6ETe6ZBk6QHv+JDsycB6
VMby8nrCZpLN+4qRC0Y55ZBFn/kspvVYW9Vq7EV5+MRtFeRfgxSnyfnZz7xv
I+f43kj1pudVomqniXwgh1vXB1YPUubcgd86tsSx4LFC5cmt6BecIL+TDW/0
aBK9gvn9VolD5NELf+JOIH8QPivCF07VD+2NwfzpEKaCH8wlJyimhftN2/+s
hxxbd467Aq7x3cbxh6fYL3eoYL6uV7xsAO3POddnWHQeqDLayWWM8KEZ2M2h
WfIcvEQosXUf9luW3JYm8nkXWUYJ+plZxboFwbrC70yW4/pczf+IBFM/xyMi
bOS3Dh6vIotI8yVHIh81aGRyYFaeuI4q6hvobVpwHi5UWSqYhfH1e66VkOX6
vJetQG6iMW15Ab6WJrFYBv6rasMbAl9KcRAuR71Hyg055PbF3XuVkF+Tlzt4
EXbUtrVOpf3NjJ4mhwgPffwH3nH8d+oleL3+ZSlanxwZa91QOg9l7RLTsR7R
R+rGyJMDE2+cMb7fdEP8ZTjG6IinEvolSkTtDKPzZ8yUuQn7q/bAzyGyb4z2
xtkYf1i4ViECbozw/JyO9WrdI9NLVrUqfWqO97FgdwQnEjaJ/e3wHbmhx3fZ
KOpXWFN/CfULVI+0k0N1RWo5cJdKNesKLJ0T3yaN8VXO61ZH0/tc11gXAjPl
w5rIcrtsO5MxvmXrhNtVWGaIFWiHfI69+bJrtJ+391br0/rLVVaR+Xtsvhbg
ekxs1jjEwMKD03EzyCWsQxfEwncWTTSHwfvXjZWQg4VCv3Sh3vfDplZxsH2N
5UEuWMD8EW883U+aK98k6nFWrc4lexvz/2jHepw5dPFgAo330lA+jfyp8eg0
OVImZcAb6x0qdigtER7uHm90hGsPPNC9Ts9TqLfNAPNrgi7E34D5xnNrpPC8
+vZ93XkT/nd+yJ9h2s96xp/I1t7J5+h71KqzQjEZ3il0OTgN82fpcHrJXKrF
FQrwN98vnBRY5ZusbQfmx2kbyqXCGuIMy17k99ml7WSZDIfhebA6W5ydBtsG
iQcHwIp7glan0/VlKdmP4v6TWMNN5EUTvqa26G/PMnDPgL98Nzrri/E3tYqX
ZcJZZdIVC2B91vJq8saaw7/y0N+SFehwC44QuL1/EOsdxhpakAWvZnL6fej8
Ze0vJa8xtSsSQD8p9j2rbFhcJXf3bOTX2cv4bsMdruVFcqgv5eufSx7/9sPK
Bz7tpzdzB67L7n01ivrrA5bq5cL9+yanJJCvD/QdJ+t4a2pV0Xl7rj8+D34c
rDglDguV6ezKh2XDjKKvwIbl+Z/IaUUbJgXg35wlkXfhTxqb7TJxPysfsRQL
4MCzRUUydF5UfOglr18Y8yQSzz/ykvb5Qlgq4WSYEOb/rM6VuwcHnCt2GsP9
/IzwZhfBmhf8l77B9d5seLe6mL7XZTIdBXBeo1YzuXbrLWcL9OPMynEvgb0S
urOjMX/JcyHRUvi1pFV6I/o7v/CsJrdffp3CAwfP7XW4Dzf4tXUYo57Fq90L
y+AXE9YpS/B9muzMLiWXxTTl0ftvvHChdTlsyRDNkKPfDz1n+R7AJWJeL8fh
6SVvc8lrZJKuJNH3S0Tj0EN6n4MjE2h/GQ3emiFz/Rg4Nol+kisE0x/Bg3Gf
Hk4gN5c8o1cBd/l8SdLC/GUyOxMq6f1xWn6SvmeRspm7qmCt5cevciP3mpo/
TLbRfr9NHu7a5h5ZTfvz8XOz1xgfq9ilWEPnXdOvpxXIXbarvSMH5LP8b6G/
tXr6+Vo6/6fUPFNh+93zNj6GjUIWdA3BCr6ur8hbDKJN7qJehV4Huw6+9bCu
lfYv74EdUvV0Howz+2qRL7mU2kwW1E4THsD8HrO5pxvg8FXcJ0uQi0WfEn0C
S7Dz+80x/3FsezXZxMJT+SnGP7VXOdEIh/3tCxCm9U5JXtgEG15/H0Hf2+2Z
fPfJD3ZIF3kjDz170roZjgpM7DiM+rp3X/I9hS8Gyel2wz7FSnlkr4PRWtdR
fx7n5qFn8LvKRTubaH2reP6Q64JdzILhi3WO6c/pe7FecjIZ86u5WvVaYBcT
adOj8NGO6wkv4LkJSb0/4U4hbo1W2OLL70z6/TSnz2GYXOgt8/oC9td/sHkm
cw==
       "]]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.007333333333333334],
       AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwV1nc8lusfB3BJJCH1yzFKhSQlTRTxSKHQQZJNEyVlFOJBWRllhJCyZ0bT
TkaH7HFEGgidjEJp8uD3+f7h5fV+fa51f+/rvq5n3YkLBqfZ2djYSvBH/3lG
x4QMgscYvVPP+c7MTag6rzCoJL/8GnZmaH5CdR9Xsc0RWG78zq5nbJOqA1vF
+A1h7+rfa8fQfs+EbyF5QGp5/iC8m1dvkRFsVhN0XHHBpGpP49Nc8sBaXoVo
5IxKUcNj8BlmeNsJ5G6jV2fIxnImqWYY3zr7U4oxHCdWeO4o2i+7p3vIBNbU
/JJjh/WEvXz8ldwrlesSDNcFCseZwhVa4947MJ7DI2+GGfz7dBuDD+N1OX78
RGYaW6t3YTxOG+0wc9hNWpylhXw24qG8Bbw47XpgE8Z7qv9XL3mE8XMJD3JZ
Taa/JSxTo1uWgNzeaXCzFdwg0z1F+Srbg51kbrEdC1ORv7Mo8LCGU1lrWpXg
siMrJY7DQZ993Pej/eODHg3kopQve8spV/3geILqma0rIEv13aUpfBJmXKkT
V4fFN+dVkncxbme9wfq3G6+wPQULO0+Lb0M+IuTOfxpuduhPGke+8UBfIXkm
9/F3YeT1Sgcsz8CJ1799PoG8jZWzyAaWD2UpXpnF+1jramgLB7fO/LUT7W9/
eDdDHrs1p7QAuQ2feqodzB4V4P6L8kXZh87CD7T2cofB8nV838h2+sbRxfDh
7y5x52CXvNCRheyTqi1jbxj2VJ9xCUcW5j89yBgm8/aMSOnDK99mhJ2HdY12
j8ehHu87lio4wG9ioowUMF55g1MvefJ/3z7rYrzy6tf+F+CTl1+bSSFvKlWR
vQhnKV3a2ANPPUrrJHd3rOMdhZXuL/F0pP3o4ThP+b6eixJOMFcZx+ZkeElC
VwM5Q1g8oQvzR0YpOznDwwOJGlYzE6rJZYurXGi/McqklyGv93KwvQSHD7zN
ekX7Na+T/zL81kNaUgnPY5uxp4gcfXKGqwT5a7skS1f4mtllpV64MpaT0w2e
mJ5yiID5I+3zyM2nB1XrUO8NVR2G7rSe/CHv5cjH/RRZZL1R2Xn6HgK87qVe
gdUOugfR+/0vj0PbAx5KDmDzht+fa4vzhPO4ctYtwvfgf0dejQlfFxke3YH+
Q1YJw2QelbE8JeTlYezhXvDuFX2udujPCrJV8Ia9JM/6jaB92uGWXjKfiELR
KTx/jdfOAB84do0KBz/6a7vHy16Fi7cpjkgh36PC9oq8rasw7T7sZNck4Qtr
qTCHF+L5srdsbyT/8I1yvYX5TKxinfzovMkqFOpB7mg6J+wP23PMdVogzzp6
qorcOqU9dAzrmdRrsA2g/eJykJsb4+vpbF0WCIs6KmSFo32dZkwRWTJUKug7
2h9TZ1leh7dvFevmQPt5lROcQTS/2KByLPKKPS/zyJVnFf9dhTxGfsvRYLjd
uGbrbdrftlEscvF9wdUL4b2nplNDYKPfLz/vRPs8GWvtUNi0JfrtXdQjyrz2
G9m9Xrqb6jlkvDn+BlyroOklh/kS1kSq3YTFeBvaN2F/vdD/PUweVt7jtQDt
zVa+UAiH+R+yVqWjHh2aMn3kkuNRCSasCdVH+8MDImBr3bNXfyE3cP0pGwkf
eB/sHozxH6mYvyJP/Lm+2RfuUar2vAWrJ/yck0D7KgdpyShY+u5kvx9sK3+z
kRxjpetO9Wjb8d0pGrZ61l1rjnyxjalIDFx+UiRYjeq/pbKKHHmJ7Vky1nPs
hJTdbfi82/Hdw8jXWIcui4U1nqYmOsKHpb8VkY1zNPpLMN5PM2OrOPjduWm7
XvTnM63gjKfvNWN7ZjMcIC6ZT25vdvOoQD0uGQUfvQOvz2nZqoK82XCSRRa6
1uhlgXqHrjZKS4A9Dz5J04Ff6Jdr34XTpgsM5dC/xu96/D24fnSwgc7/Qd1x
tUTYttFaks6bGh3DEfKH/DN6e9G/49BaxWTaTx+NbjijP/uhgD6ywB81aU74
q9fngBS6z5j7YxzQP07LYEsq/LQgOjwbeQmz+BW56ovRbDZyBlOMmUbvc1Qr
7RByRU0/yXTYsvSUgQ/qkeQ52kjub+9YKYv5bTz1nDNg5brpXE20T9QoFMmE
HapWhzzAeH97rqom/5SxdFWHLT2v2WXR+97Ub8DE8930HF6WDd/eeNFMC+O1
eB4uJsts5fuUjfqtZz6xyoH9IuIyOzD+XaYI133a/0/WK9D+W+/lk0/e2yM4
pge7eOvM5sIhCgmG2Rh/01UhnXx6fyK8BvQ9bLrmNUVOq74zm0Xnre9QfAH8
530F3xJ4eemhfQ9gZ4eN0r6wQdmDEfJ3h0/q7PB0gGDEQ/iekG4vvY91FZ6K
j2DxehM1KTovng/0kU19WrJisP6IEK3Ax3S+GXa+FUL/39X5W57Q/iowT5/D
8/4Ov8J8Cm9wanu8COMlvuyXLKTv18Rl6Uesv6BBo4msa6DZQvMFsOc5F8Gc
BTZFxegv2LpctJjqt0uCSxTtHdrdqslpzEF/M6zHn7vPrgRme8zb/Qi5Rdd+
gVK6D2Jq/bRwP/14nVNMVoqImkrF+gwFBKzL6H7g7vRNot8PvZe5yun89Uzn
2UXnreD7fDK3nAjrPd1fwupGz+h+vZU+vxE+8ilrlszu7PPGBf0l1vKnV8Cz
XzlL9yA3lbik85zqV+TdEAiLyKjdqaT788C32B1whGzmviq6b1e0F9PvD/eZ
paPkWSn7HNrfPTudI6rhJ4b7lGXgWMUexRr4a2282gx8UVm1n7zppmiTEOa3
ZqQHvqD9Obc0hA+22c8j9w/s+7zq0mFYwcuxixwqsW1+Mfo/1+lm1sJH4mdv
KsOc+nvX19H38F/fBdofgiGpTeQrihbvNqN/rwm3y0s4145XYwpeHXVBtJ7q
f1jD2AXt/4l9VU1uUjVf+Av1b7ZROttA+zE2IUmC6p2SLNBI50/QGQYP3qdy
JlcJOcTi2g26H0Mvn7duovcd87e8OcbXfvgvVzPtn3rZvFbYo3B3AXnV+S+3
6fzkCUg0aoFTpiNcy6i+VYvmyJFPSrMd4ODac+mtVM/mwHx79K9e0KHTRvON
25euhY93373TDu96lZKUAb9ezqHeARdw+P2g97940G6UnDmjUrwB++v/VMsY
3A==
       "]]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.007333333333333334],
       AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.007333333333333334],
       AbsoluteThickness[1.6]}, {}, {}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.007333333333333334],
       AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.007333333333333334],
       AbsoluteThickness[1.6]}, {}, {}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{56402.481676080926`, 0.9993465402168458},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{56402.481676080926`, 56406.591114943905`}, {0.9993465402168458,
    1.0005625968636274`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.788344235756179*^9, 3.788344261493178*^9}, 
   3.7883557051617804`*^9, 3.7883673547087803`*^9, 3.788391886265871*^9, 
   3.788435426863598*^9, 3.788458331666263*^9, 3.7891408284070044`*^9, 
   3.78914758927318*^9, 3.789748877869514*^9, 3.7909649031821012`*^9, 
   3.792578387965733*^9, 3.8022635647993097`*^9},
 CellLabel->
  "Out[427]=",ExpressionUUID->"96ccb49a-08d8-49ee-bb1c-4940926332e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  SubscriptBox["powerlist", "j"], "]"}]], "Input",
 CellChangeTimes->{{3.788344389168174*^9, 3.7883443910130987`*^9}},
 CellLabel->
  "In[428]:=",ExpressionUUID->"a172774f-d9c0-410c-aef7-b918825d3911"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{3.788344391294092*^9, 3.788355705192935*^9, 
  3.7883673547494307`*^9, 3.788391886309349*^9, 3.7884354268859453`*^9, 
  3.7884583317376003`*^9, 3.789140828427136*^9, 3.7891475892936697`*^9, 
  3.7897488779296494`*^9, 3.790964903210896*^9, 3.792578387997591*^9, 
  3.802263564849186*^9},
 CellLabel->
  "Out[428]=",ExpressionUUID->"061a6b9b-b2bc-43a3-907f-fca5265a4463"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{
     SubscriptBox["powerlist", "j"], "[", 
     RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "[", 
      SubscriptBox["powerlist", "j"], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", 
  SubscriptBox["times2", "j"], "]"}]}], "Input",
 CellChangeTimes->{{3.788344847940114*^9, 3.788344890301628*^9}},
 CellLabel->
  "In[429]:=",ExpressionUUID->"0fc0ff85-ab5e-4679-9825-1e24136d6ea9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"185", ",", "185", ",", "185", ",", "185", ",", "185", ",", "185"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.788344866463378*^9, 3.788344890718541*^9}, 
   3.7883557052315702`*^9, 3.78836735478424*^9, 3.788391886346306*^9, 
   3.788435426923953*^9, 3.7884583318051243`*^9, 3.789140828463168*^9, 
   3.789147589331871*^9, 3.789748878033152*^9, 3.7909649032471952`*^9, 
   3.792578388042449*^9, 3.80226356495369*^9},
 CellLabel->
  "Out[429]=",ExpressionUUID->"50f9149b-a946-4920-90fa-5cfeb11c30a8"],

Cell[BoxData["169"], "Output",
 CellChangeTimes->{{3.788344866463378*^9, 3.788344890718541*^9}, 
   3.7883557052315702`*^9, 3.78836735478424*^9, 3.788391886346306*^9, 
   3.788435426923953*^9, 3.7884583318051243`*^9, 3.789140828463168*^9, 
   3.789147589331871*^9, 3.789748878033152*^9, 3.7909649032471952`*^9, 
   3.792578388042449*^9, 3.802263564959186*^9},
 CellLabel->
  "Out[430]=",ExpressionUUID->"57390b19-0776-4c97-8d1e-de453e5736e9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "z", "]"}], ";", 
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "epochloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{
   SubscriptBox["times2", "j"], "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["powerlist", "j"], "[", 
         RowBox[{"[", "z", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1", ",", 
         RowBox[{"Length", "[", 
          SubscriptBox["powerlist", "j"], "]"}]}], "}"}]}], "]"}], "]"}], 
    "]"}]}], ";", 
  RowBox[{"k", "=", "0"}], ";", 
  RowBox[{"m", "=", "0"}], ";", 
  RowBox[{"Label", "[", "timeloop", "]"}], ";", 
  RowBox[{"k", "=", 
   RowBox[{"k", "+", "1"}]}], ";", 
  RowBox[{"temp", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       SubscriptBox["powerlist", "j"], ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "==", 
       RowBox[{
        SubscriptBox["times2", "j"], "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "temp", "]"}], ">", "0"}], ",", 
    RowBox[{"m", "=", 
     RowBox[{"m", "+", "1"}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "temp", "]"}], ">", "0"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"temp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ">", "1"}], ",", 
      RowBox[{
       SubscriptBox["avg", "m"], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["times2", "j"], "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Median", "[", "temp", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Median", "[", "temp", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1.4286", 
              RowBox[{
               RowBox[{"MedianDeviation", "[", "temp", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]}]]}], "}"}]}], 
      ",", 
      RowBox[{
       SubscriptBox["avg", "m"], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["times2", "j"], "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Median", "[", "temp", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Median", "[", "temp", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "<", 
     RowBox[{"Length", "[", 
      SubscriptBox["times2", "j"], "]"}]}], ",", 
    RowBox[{"Goto", "[", "timeloop", "]"}]}], "]"}], ";", 
  RowBox[{
   SubscriptBox["averaged", "j"], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["avg", "kk"], ",", 
     RowBox[{"{", 
      RowBox[{"kk", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "epochloop", "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.788344286322226*^9, {3.788344319187442*^9, 3.788344465366068*^9}, {
   3.788344526253302*^9, 3.788344594723668*^9}, {3.7883446708801937`*^9, 
   3.7883447374778643`*^9}},
 CellLabel->
  "In[431]:=",ExpressionUUID->"f8f39cd4-668f-4289-9de4-592c29f3030a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "ErrorBarPlots`"}]], "Input",
 CellChangeTimes->{{3.7670992259536047`*^9, 3.767099229623735*^9}},
 CellLabel->
  "In[432]:=",ExpressionUUID->"e8249c12-16e6-466d-900d-d75c17c5b9ac"],

Cell[BoxData[
 TemplateBox[{
  "General", "obspkg", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"ErrorBarPlots`\\\\\\\"\\\"}]\\) is now \
obsolete. The legacy version being loaded may conflict with current \
functionality. See the Compatibility Guide for updating information.\"", 2, 
   432, 35, 20158030274380843858, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8022635664963303`*^9},
 CellLabel->
  "During evaluation of \
In[432]:=",ExpressionUUID->"fd158c99-3a48-4005-8816-68ce08732353"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"thisepoch", "=", 
   RowBox[{"tau0", "+", 
    RowBox[{"period", " ", 
     RowBox[{"Round", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"Median", "[", 
         RowBox[{
          SubscriptBox["averaged", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "-", "tau0"}], 
       "period"], "]"}]}]}]}], ";", 
  RowBox[{"tmin", "=", 
   RowBox[{
    RowBox[{"Min", "[", 
     RowBox[{
      SubscriptBox["averaged", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "-", "thisepoch"}]}], 
  ";", 
  RowBox[{"tmax", "=", 
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{
      SubscriptBox["averaged", "j"], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "-", "thisepoch"}]}], 
  ";", 
  RowBox[{
   SubscriptBox["twindow", "j"], "=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"-", "tmin"}], ",", "tmax"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["fluxmin", "j"], "=", 
   RowBox[{"Min", "[", 
    RowBox[{
     SubscriptBox["averaged", "j"], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["err", "j"], "=", 
   RowBox[{"Median", "[", 
    RowBox[{
     SubscriptBox["averaged", "j"], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";", 
  RowBox[{"Twindow", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      SubscriptBox["twindow", "jj"], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "1", ",", 
        RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fmin", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["fluxmin", "jj"], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", 
          RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"NumberQ", "[", "#", "]"}], "&"}]}], "]"}], "]"}]}], ";", 
  RowBox[{"ERR", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["err", "jj"], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", 
          RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"NumberQ", "[", "#", "]"}], "&"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.767099052999785*^9, 3.7670990532349567`*^9}, {
   3.7670991097008133`*^9, 3.767099119239162*^9}, {3.767099231359606*^9, 
   3.7670992339562283`*^9}, {3.767099460893605*^9, 3.767099464007936*^9}, {
   3.767099520662998*^9, 3.767099521651733*^9}, {3.7670995609718246`*^9, 
   3.76709981017642*^9}, {3.767099875957036*^9, 3.767099895934947*^9}, 
   3.767606613131769*^9, {3.7676071042474823`*^9, 3.767607104691634*^9}, 
   3.767607136411723*^9},
 CellLabel->
  "In[433]:=",ExpressionUUID->"e0a9eb4e-25e7-4939-bb2c-535270dc6fae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"epochs", "[", 
      RowBox[{"[", "jj", "]"}], "]"}], ",", 
     SubscriptBox["twindow", "jj"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"jj", ",", "1", ",", 
     RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.788362265261321*^9, 3.788362308820837*^9}},
 CellLabel->
  "In[435]:=",ExpressionUUID->"93adaab1-ad30-43d2-9224-ed4bc7592e35"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"1\"\>", ",", "2.016201541038754`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"2\"\>", ",", "2.019465444442176`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"3\"\>", ",", "2.0527377005346352`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"4\"\>", ",", "2.017773245170247`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"5\"\>", ",", "2.0117884968058206`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"6\"\>", ",", "2.022209489106899`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"7\"\>", ",", "2.0788738198316423`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.78836227115663*^9, 3.788362309498733*^9}, 
   3.788367363817006*^9, 3.788391895406008*^9, 3.788435433886856*^9, 
   3.788458336913619*^9, 3.7891408300276423`*^9, 3.7891475920010357`*^9, 
   3.7897488834124727`*^9, 3.7909649064171247`*^9, 3.792578389717134*^9, 
   3.802263566612064*^9},
 CellLabel->
  "Out[435]=",ExpressionUUID->"4db72905-75b9-4dd2-88b0-159f5d0595ea"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"j", "=", "0"}], ";", 
  RowBox[{"Label", "[", "jloop", "]"}], ";", 
  RowBox[{"j", "=", 
   RowBox[{"j", "+", "1"}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      SubscriptBox["averaged", "j"], "]"}], ">", "0"}], ",", 
    RowBox[{"thisepoch", "=", 
     RowBox[{"tau0", "+", 
      RowBox[{"period", " ", 
       RowBox[{"Round", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"Median", "[", 
           RowBox[{
            SubscriptBox["averaged", "j"], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "-", "tau0"}], 
         "period"], "]"}]}]}]}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      SubscriptBox["averaged", "j"], "]"}], ">", "0"}], ",", 
    RowBox[{
     SubscriptBox["plotty", "j"], "=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["cofiam", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"thisepoch", "-", "Twindow"}], ",", 
              RowBox[{"thisepoch", "+", "Twindow"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "+", 
               RowBox[{"3", " ", "ERR"}]}], ",", 
              RowBox[{"Fmin", "-", 
               RowBox[{"3", "ERR"}]}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
             RowBox[{"0", "/", "7"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"thisepoch", "-", "Twindow"}], ",", 
              RowBox[{"thisepoch", "+", "Twindow"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "+", 
               RowBox[{"3", " ", "ERR"}]}], ",", 
              RowBox[{"Fmin", "-", 
               RowBox[{"3", "ERR"}]}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "0.4"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"800", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<BJKD\>\"", ",", "\"\<relative intensity\>\""}], 
           "}"}]}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "\"\<CMU Serif\>\""}], ",", 
            RowBox[{"FontSize", "\[Rule]", "22"}]}], "}"}]}]}], "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["local", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
             RowBox[{"1", "/", "7"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["polyam", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
             RowBox[{"2", "/", "7"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["gp", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
             RowBox[{"3", "/", "7"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["cofiam2", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
             RowBox[{"4", "/", "7"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["local2", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
             RowBox[{"5", "/", "7"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["polyam2", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
             RowBox[{"6", "/", "7"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["gp2", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
             RowBox[{"7", "/", "7"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"ErrorListPlot", "[", 
         RowBox[{
          SubscriptBox["averaged", "j"], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"thisepoch", "-", "Twindow"}], ",", 
               RowBox[{"thisepoch", "+", "Twindow"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "+", 
                RowBox[{"3", " ", "ERR"}]}], ",", 
               RowBox[{"Fmin", "-", 
                RowBox[{"3", "ERR"}]}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.4"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"800", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<BJKD\>\"", ",", "\"\<relative intensity\>\""}], 
            "}"}]}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontFamily", "\[Rule]", "\"\<CMU Serif\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "22"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Lighter", "[", "Black", "]"}]}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"pts", ":", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"x1_", "?", "NumericQ"}], ",", "_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x2_", ",", "_"}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", "_"}], "}"}], "..."}]}], "}"}]}], "]"}], "/;", 
          RowBox[{"x1", "\[NotEqual]", "x2"}]}], "\[Rule]", "Nothing"}]}], 
       ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["averaged", "j"], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Lighter", "[", "Black", "]"}]}]}], "]"}]}], "]"}]}]}], 
   "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      SubscriptBox["averaged", "j"], "]"}], ">", "0"}], ",", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"thisfolder", ",", "\"\<AVG_SAP.\>\"", ",", 
        RowBox[{"epochs", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<.pdf\>\""}], "]"}], ",", 
      SubscriptBox["plotty", "j"]}], "]"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      SubscriptBox["averaged", "j"], "]"}], ">", "0"}], ",", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"thisfolder", ",", "\"\<AVG_SAP.\>\"", ",", 
        RowBox[{"epochs", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<.dat\>\""}], "]"}], ",", 
      SubscriptBox["averaged", "j"], ",", "\"\<Table\>\""}], "]"}]}], "]"}], 
  ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "<", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"Goto", "[", "jloop", "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7670998184456863`*^9, 3.767099869037319*^9}, {
  3.767099899141914*^9, 3.767099905991589*^9}, {3.767099981145314*^9, 
  3.767100196035372*^9}, {3.767606648815207*^9, 3.767606687197991*^9}, {
  3.7676072581306047`*^9, 3.7676072673856497`*^9}},
 CellLabel->
  "In[436]:=",ExpressionUUID->"f39446d2-f7da-418f-9e6f-af585bb90cf1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AVGsap", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["averaged", "j"], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "epochs", "]"}]}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"thisfolder", ",", "\"\<AVG_SAP.dat\>\""}], "]"}], ",", "AVGsap", 
   ",", "\"\<Table\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.767100205757093*^9, 3.7671002076000347`*^9}},
 CellLabel->
  "In[437]:=",ExpressionUUID->"b4980efe-033f-4254-bc07-89b6b723d48f"],

Cell[BoxData["\<\"/Users/davidkipping/Storage1/Work/Documents/Transit_Work/\
PAPERS/Undersampled/LIGHTCURVES3/SINGLES/KOI-3508.01/planet1/AVG_SAP.dat\"\>"]\
, "Output",
 CellChangeTimes->{
  3.767100208826543*^9, 3.767446739427671*^9, 3.767447873181635*^9, 
   3.767606495036018*^9, {3.767606705592943*^9, 3.76760673016438*^9}, 
   3.767607301644905*^9, 3.7676085176583567`*^9, 3.785584090708445*^9, 
   3.785692557107777*^9, 3.788284823155508*^9, {3.788344786820963*^9, 
   3.7883448142263193`*^9}, 3.78835573193261*^9, 3.788367398119331*^9, 
   3.788391910564336*^9, 3.7884354451907263`*^9, 3.788458345542948*^9, 
   3.7891408329878807`*^9, 3.789147594531949*^9, 3.789748909110591*^9, 
   3.790964911928769*^9, 3.792578397468498*^9, 3.802263571616452*^9},
 CellLabel->
  "Out[438]=",ExpressionUUID->"4b6c8270-6fb6-49c3-bc21-e7258ff6ec1e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1272, 804},
WindowMargins->{{277, Automatic}, {Automatic, 55}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a30dfe84-854b-4c4d-87d3-761b30c5ae84"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 156, 3, 37, "Input",ExpressionUUID->"ae4340d8-7b4a-4067-b886-e6a221ec20ab"],
Cell[717, 25, 4760, 117, 584, "Input",ExpressionUUID->"a9058255-8e17-4f72-b948-133f50fa2eda"],
Cell[CellGroupData[{
Cell[5502, 146, 154, 3, 84, "Section",ExpressionUUID->"71544f96-9c9f-4ec9-b191-5ffdba05b8e8"],
Cell[CellGroupData[{
Cell[5681, 153, 587, 10, 37, "Input",ExpressionUUID->"9747e039-7f2b-4bcd-a1a6-8cf3e90389ef"],
Cell[6271, 165, 977, 15, 69, "Output",ExpressionUUID->"61688168-2fa2-433b-8b62-1532cdd65669"]
}, Open  ]],
Cell[7263, 183, 2763, 76, 376, "Input",ExpressionUUID->"4f49b4ff-9196-41db-be48-b313d44942f8"],
Cell[CellGroupData[{
Cell[10051, 263, 166, 3, 67, "Subsection",ExpressionUUID->"24b59279-de38-46c0-8f4d-028851c17212"],
Cell[10220, 268, 2089, 55, 220, "Input",ExpressionUUID->"9e82d6c9-037e-49db-8405-5165d04dd674"],
Cell[12312, 325, 1918, 51, 116, "Input",ExpressionUUID->"820fccb3-0079-4480-8bbb-f371155ce06b"],
Cell[14233, 378, 3701, 100, 220, "Input",ExpressionUUID->"f52badd7-367a-4d01-a808-7d7c91c11aac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17971, 483, 158, 3, 67, "Subsection",ExpressionUUID->"8bf8f9d0-8206-44ba-9777-bc87a8de7228"],
Cell[18132, 488, 1312, 36, 277, "Input",ExpressionUUID->"4d88f69a-79d2-4619-96bf-26e191c46f8b"],
Cell[19447, 526, 1255, 35, 277, "Input",ExpressionUUID->"2e93ba8a-7bee-4051-90ed-a943751c796d"],
Cell[20705, 563, 1264, 35, 437, "Input",ExpressionUUID->"827d5e9e-3309-4094-b5e4-e583f6e6f7dc"],
Cell[21972, 600, 1244, 35, 437, "Input",ExpressionUUID->"95ad52ec-2841-471c-9529-6e093a71fccd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23253, 640, 223, 4, 104, "Subsection",ExpressionUUID->"3f24f731-9743-48cf-926e-5d0001a3d9b6"],
Cell[23479, 646, 431, 11, 37, "Input",ExpressionUUID->"48863379-475e-463e-9994-cff7a7880182"],
Cell[23913, 659, 2462, 68, 405, "Input",ExpressionUUID->"3d722d60-dd0c-4048-81d5-779f26c79c7f"],
Cell[26378, 729, 2405, 68, 405, "Input",ExpressionUUID->"1631d968-6c74-44a6-9b22-476ce7c3b505"],
Cell[28786, 799, 2415, 68, 408, "Input",ExpressionUUID->"338e7d52-b107-4094-bb3b-cfb03d853884"],
Cell[31204, 869, 2394, 68, 637, "Input",ExpressionUUID->"cc120720-6bb5-49c4-808d-d420353940d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33635, 942, 170, 3, 104, "Subsection",ExpressionUUID->"2b4c658e-aeda-4592-9c17-f11ddb503599"],
Cell[33808, 947, 7505, 215, 1534, "Input",ExpressionUUID->"607958bc-1a3b-4b6d-8c20-6ec3aba19371"],
Cell[41316, 1164, 7504, 215, 982, "Input",ExpressionUUID->"7f2c2098-252c-457b-9a80-f8d47ffcd942"],
Cell[CellGroupData[{
Cell[48845, 1383, 7602, 216, 978, "Input",ExpressionUUID->"1b68da7b-d787-49fc-b9f1-2dcfab33910a"],
Cell[56450, 1601, 591, 12, 29, "Message",ExpressionUUID->"5ed1765d-ec01-459b-8c47-eb431545b21c"],
Cell[57044, 1615, 467, 10, 29, "Message",ExpressionUUID->"eb2ea866-84ae-4d90-837a-e4279f24e6af"],
Cell[57514, 1627, 593, 12, 29, "Message",ExpressionUUID->"38a09ca4-14a2-42f8-9867-ed961614fa37"],
Cell[58110, 1641, 467, 10, 29, "Message",ExpressionUUID->"62125060-feaa-4078-bb06-30bbda7fd1f7"],
Cell[58580, 1653, 591, 12, 29, "Message",ExpressionUUID->"4a5fc10d-1d8b-4345-878e-445790150bda"],
Cell[59174, 1667, 545, 11, 29, "Message",ExpressionUUID->"169e35b5-747f-4235-9356-1525ba8dc098"],
Cell[59722, 1680, 467, 10, 29, "Message",ExpressionUUID->"2590664f-0f15-4984-8297-272b7735aa07"],
Cell[60192, 1692, 547, 11, 29, "Message",ExpressionUUID->"053e2148-d831-4907-82e4-a968899cf6a9"]
}, Open  ]],
Cell[60754, 1706, 7546, 216, 984, "Input",ExpressionUUID->"038884b3-423a-4de1-9578-b3e47c06af27"],
Cell[68303, 1924, 7557, 216, 982, "Input",ExpressionUUID->"515c1c55-e858-46d7-add6-f74f2c509004"],
Cell[75863, 2142, 7654, 217, 1008, "Input",ExpressionUUID->"3b0883b5-8fd3-4b62-a055-80a3679e7817"],
Cell[CellGroupData[{
Cell[83542, 2363, 7609, 216, 978, "Input",ExpressionUUID->"f5a38373-e6f1-43c0-bf66-8220cdb83004"],
Cell[91154, 2581, 643, 13, 29, "Message",ExpressionUUID->"7d3b6733-3ac0-4047-bdf1-8a19b496ffe9"],
Cell[91800, 2596, 518, 11, 29, "Message",ExpressionUUID->"c2bbf98e-8595-4651-8d74-ab8f75c3c3ba"],
Cell[92321, 2609, 643, 13, 29, "Message",ExpressionUUID->"938f2446-a7d0-4500-ba35-d44f5ce3d321"],
Cell[92967, 2624, 521, 11, 29, "Message",ExpressionUUID->"0c349401-3781-46c2-8c33-e5c5c0866f5c"],
Cell[93491, 2637, 645, 13, 29, "Message",ExpressionUUID->"e092b123-6850-4110-a226-61d8171e5b61"],
Cell[94139, 2652, 597, 12, 29, "Message",ExpressionUUID->"532d5200-2d0b-4817-be83-4963bd036ee3"],
Cell[94739, 2666, 519, 11, 29, "Message",ExpressionUUID->"06c1317f-dbf8-4606-a2d5-b7565d48a9f4"],
Cell[95261, 2679, 597, 12, 29, "Message",ExpressionUUID->"e19205a6-0d7d-4626-9443-db37e7249856"]
}, Open  ]],
Cell[95873, 2694, 7547, 216, 1537, "Input",ExpressionUUID->"a5ec8da1-5a2b-43fc-9c09-677babbca91b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103457, 2915, 233, 4, 104, "Subsection",ExpressionUUID->"5489413d-a4bd-4c4c-abe9-460090baa532"],
Cell[103693, 2921, 1293, 37, 72, "Input",ExpressionUUID->"dbdabf07-f391-4f9b-a553-847364b02898"],
Cell[CellGroupData[{
Cell[105011, 2962, 2508, 70, 324, "Input",ExpressionUUID->"a38b487b-5601-436a-8f97-516dd1ce3d67"],
Cell[107522, 3034, 842, 16, 42, "Output",ExpressionUUID->"f37f30bb-87a4-42c5-970f-a0d88b90e1f9"],
Cell[108367, 3052, 568, 9, 42, "Output",ExpressionUUID->"e0185ac4-744d-4b37-ae63-09a400aed8bf"],
Cell[108938, 3063, 568, 9, 42, "Output",ExpressionUUID->"4cc004c8-8582-4b5c-8a13-7a34b3af144c"],
Cell[109509, 3074, 576, 9, 42, "Output",ExpressionUUID->"8644dfca-e84a-4151-aa6c-36e7144d0487"]
}, Open  ]],
Cell[110100, 3086, 296, 7, 57, "Input",ExpressionUUID->"ac181a87-4adb-4b88-9a1f-57ba6d9eed4d"],
Cell[CellGroupData[{
Cell[110421, 3097, 153, 3, 87, "Subsubsection",ExpressionUUID->"6564553c-3000-450d-92e5-5ec156a15a5f"],
Cell[110577, 3102, 5279, 156, 989, "Input",ExpressionUUID->"d0dcc8fb-ad9b-472a-89a5-a012bda42dfa"],
Cell[115859, 3260, 5275, 156, 989, "Input",ExpressionUUID->"8c0bf51b-2812-4b43-86a1-98864d5b2c96"],
Cell[121137, 3418, 5280, 156, 992, "Input",ExpressionUUID->"0101a4fa-f21d-499a-87f1-d0871438d5b5"],
Cell[126420, 3576, 5311, 156, 992, "Input",ExpressionUUID->"0966e59a-76e5-4818-8e30-4eff11ced549"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131768, 3737, 155, 3, 87, "Subsubsection",ExpressionUUID->"73de4e6b-a280-435c-8a64-d1697f143e65"],
Cell[131926, 3742, 5332, 156, 633, "Input",ExpressionUUID->"586edc56-a802-4bcd-9d8d-63679ceb7eb6"],
Cell[137261, 3900, 5327, 156, 633, "Input",ExpressionUUID->"ef6787a2-8f8a-43be-9838-97bf845a517a"],
Cell[142591, 4058, 5331, 156, 635, "Input",ExpressionUUID->"c23e3e4d-d585-4926-ac46-a21ebd1dda8f"],
Cell[147925, 4216, 5365, 157, 635, "Input",ExpressionUUID->"64a52cd3-92a5-4d5c-9ece-a2a9a7959928"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153327, 4378, 211, 4, 56, "Subsubsection",ExpressionUUID->"c19e8e31-cb1c-4327-bdea-9770c2d4a034"],
Cell[CellGroupData[{
Cell[153563, 4386, 818, 20, 70, "Input",ExpressionUUID->"ad6bc19a-8200-46cf-bf95-60daca3d0dc3"],
Cell[154384, 4408, 2171, 43, 185, "Output",ExpressionUUID->"d45d3f00-d826-4491-b392-af19b4b9e4dc"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[156616, 4458, 184, 3, 104, "Subsection",ExpressionUUID->"04a4ed69-daca-4e49-a1b2-4d2637101cbd"],
Cell[156803, 4463, 179, 5, 57, "Input",ExpressionUUID->"1a8c6145-84dd-494c-a6a4-0b2a75434c0a"],
Cell[CellGroupData[{
Cell[157007, 4472, 156, 3, 56, "Subsubsection",ExpressionUUID->"a6b47c91-23f6-44f8-89f9-f288435a5ea0"],
Cell[157166, 4477, 12012, 352, 1562, "Input",ExpressionUUID->"dbb69cf5-6b73-4aed-a4f6-3f0203d9df91"],
Cell[169181, 4831, 12008, 352, 1562, "Input",ExpressionUUID->"18b26aa7-3279-471e-aac9-89956248849e"],
Cell[181192, 5185, 12064, 353, 1566, "Input",ExpressionUUID->"9ada7ea4-29df-4b5f-a4ee-380c7aed600d"],
Cell[193259, 5540, 12045, 353, 1566, "Input",ExpressionUUID->"8cbe16bb-97d3-493b-96b0-18390761e598"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205341, 5898, 205, 4, 56, "Subsubsection",ExpressionUUID->"b3b8a836-86b7-4c8b-bcb1-2c6c0f38f505"],
Cell[205549, 5904, 12068, 353, 1562, "Input",ExpressionUUID->"6550ae81-26a9-43c9-82a7-44c9aa4f00d5"],
Cell[217620, 6259, 12066, 353, 1562, "Input",ExpressionUUID->"bf65bf64-d0cc-4f8c-91b6-3aa2273be23f"],
Cell[229689, 6614, 12115, 353, 1566, "Input",ExpressionUUID->"3c02ebe0-6869-4a5c-8b8e-557a7b1f16ac"],
Cell[241807, 6969, 12097, 353, 1566, "Input",ExpressionUUID->"5112694b-7432-4d7a-ab28-8d56472c454f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253941, 7327, 262, 4, 56, "Subsubsection",ExpressionUUID->"fc4aed7b-3ace-47b8-bb70-4ed261d2c7af"],
Cell[CellGroupData[{
Cell[254228, 7335, 875, 21, 70, "Input",ExpressionUUID->"e3c107d3-a974-43a5-860e-cc443c704c19"],
Cell[255106, 7358, 1731, 36, 185, "Output",ExpressionUUID->"e67b9d8b-2d86-4b74-91d2-517472a8ec8e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[256898, 7401, 220, 4, 67, "Subsection",ExpressionUUID->"433d1cbb-6655-477a-aa8d-b13bf0d2b475"],
Cell[CellGroupData[{
Cell[257143, 7409, 5914, 168, 381, "Input",ExpressionUUID->"9ab45b4f-719a-4063-aed5-37f9f64400db"],
Cell[263060, 7579, 724, 13, 42, "Output",ExpressionUUID->"7c802fc5-ddaf-4a74-a28a-aaf9a52bf1a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263821, 7597, 730, 23, 42, "Input",ExpressionUUID->"1fbc9d96-d67f-4cf4-b961-a6ab220fb23b"],
Cell[264554, 7622, 8644, 159, 286, "Output",ExpressionUUID->"96ccb49a-08d8-49ee-bb1c-4940926332e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273235, 7786, 240, 5, 42, "Input",ExpressionUUID->"a172774f-d9c0-410c-aef7-b918825d3911"],
Cell[273478, 7793, 417, 7, 42, "Output",ExpressionUUID->"061a6b9b-b2bc-43a3-907f-fca5265a4463"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273932, 7805, 574, 16, 70, "Input",ExpressionUUID->"0fc0ff85-ab5e-4679-9825-1e24136d6ea9"],
Cell[274509, 7823, 539, 10, 42, "Output",ExpressionUUID->"50f9149b-a946-4920-90fa-5cfeb11c30a8"],
Cell[275051, 7835, 442, 7, 42, "Output",ExpressionUUID->"57390b19-0776-4c97-8d1e-de453e5736e9"]
}, Open  ]],
Cell[275508, 7845, 3975, 119, 539, "Input",ExpressionUUID->"f8f39cd4-668f-4289-9de4-592c29f3030a"],
Cell[CellGroupData[{
Cell[279508, 7968, 209, 4, 37, "Input",ExpressionUUID->"e8249c12-16e6-466d-900d-d75c17c5b9ac"],
Cell[279720, 7974, 510, 11, 29, "Message",ExpressionUUID->"fd158c99-3a48-4005-8816-68ce08732353"]
}, Open  ]],
Cell[280245, 7988, 3399, 101, 412, "Input",ExpressionUUID->"e0a9eb4e-25e7-4939-bb2c-535270dc6fae"],
Cell[CellGroupData[{
Cell[283669, 8093, 476, 13, 40, "Input",ExpressionUUID->"93adaab1-ad30-43d2-9224-ed4bc7592e35"],
Cell[284148, 8108, 1039, 24, 42, "Output",ExpressionUUID->"4db72905-75b9-4dd2-88b0-159f5d0595ea"]
}, Open  ]],
Cell[285202, 8135, 11979, 305, 985, "Input",ExpressionUUID->"f39446d2-f7da-418f-9e6f-af585bb90cf1"],
Cell[CellGroupData[{
Cell[297206, 8444, 745, 20, 68, "Input",ExpressionUUID->"b4980efe-033f-4254-bc07-89b6b723d48f"],
Cell[297954, 8466, 840, 13, 69, "Output",ExpressionUUID->"4b6c8270-6fb6-49c3-bc21-e7258ff6ec1e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

